<!DOCTYPE html>
<!--[if lte IE 8 ]>
<html class="ie" xmlns="http://www.w3.org/1999/xhtml" xml:lang="en-US" lang="en-US">
<![endif]-->
<!--[if (gte IE 9)|!(IE)]><!-->
<!--
***************  *      *     *
      8          *    *       *
      8          *  *         *
      8          **           *
      8          *  *         *
      8          *    *       *
      8          *      *     *
      8          *        *   ***********    -----Theme By Kieran(http://go.kieran.top)
-->
<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en-US" lang="en-US">
<!--<![endif]-->
<!--Mathjax-->
<script type="text/x-mathjax-config">
MathJax.Hub.Config({
    tex2jax: {
        inlineMath: [ ['$','$'], ["\\(","\\)"]  ],
        processEscapes: true,
        skipTags: ['script', 'noscript', 'style', 'textarea', 'pre', 'code']
    }
}); 
MathJax.Hub.Queue(function() {
    var all = MathJax.Hub.getAllJax(), i;
    for(i=0; i < all.length; i += 1) {
        all[i].SourceElement().parentNode.className += ' has-jax';                 
    }       
});
</script>
<script type="text/javascript" async
    src="https://cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-MML-AM_CHTML">
</script>



<head>
  <title>算法模板 | yokel</title>
  <!-- Meta data -->
    <meta http-equiv="Content-Type" content="text/html" charset="UTF-8" >
    <meta http-equiv="X-UA-Compatible" content="IE=edge"/>
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <meta name="generator" content="yokel">
    <meta name="author" content="yokel">
    <meta name="description" content="yokel" />
    <meta name="keywords" content="" />

    <!-- Favicon, (keep icon in root folder) -->
    <link rel="Shortcut Icon" href="/img/favicon.ico" type="image/ico">

    <link rel="alternate" href="/atom.xml" title="yokel" type="application/atom+xml">
    <link rel="stylesheet" href="/css/all.css" media="screen" type="text/css">
    
    <link rel="stylesheet" href="/highlightjs/github.css" type="text/css">
    

    <!--[if IE 8]>
    <link rel="stylesheet" type="text/css" href="/css/ie8.css" />
    <![endif]-->

    <!-- jQuery | Load our jQuery, with an alternative source fallback to a local version if request is unavailable -->
    <script src="/js/jquery-1.11.1.min.js"></script>
    <script>window.jQuery || document.write('<script src="js/jquery-1.11.1.min.js"><\/script>')</script>

    <!-- Load these in the <head> for quicker IE8+ load times -->
    <!-- HTML5 shim and Respond.js IE8 support of HTML5 elements and media queries -->
    <!--[if lt IE 9]>
    <script src="/js/html5shiv.min.js"></script>
    <script src="/js/respond.min.js"></script>
    <![endif]-->

  
  
  

  <style>.col-md-8.col-md-offset-2.opening-statement img{display:none;}</style>
</head>

<!--
<body class="post-template">
-->
<body id="index" class="lightnav animsition">

      <!-- ============================ Off-canvas navigation =========================== -->

    <div class="sb-slidebar sb-right sb-style-overlay sb-momentum-scrolling">
        <div class="sb-close" aria-label="Close Menu" aria-hidden="true">
            <img src="/img/close.png" alt="Close"/>
        </div>
        <!-- Lists in Slidebars -->
        <ul class="sb-menu">
            <li><a href="/" class="animsition-link" title="Home">Home</a></li>
            <li><a href="/archives" class="animsition-link" title="archive">archives</a></li>
            <!-- Dropdown Menu -->
			 
            <li>
                <a class="sb-toggle-submenu">Works<span class="sb-caret"></span></a>
                <ul class="sb-submenu">
                    
                        <li><a href="/" target="_BLANK" class="animsition-link">AAA</a></li>
                    
                        <li><a href="/atom.xml" target="_BLANK" class="animsition-link">BBB</a></li>
                    
                </ul>
            </li>
            
            
        	<li>
        		<a class="sb-toggle-submenu">Categories<span class="sb-caret"></span></a>
            	<ul class="sb-submenu">
				  	
				    <li><a href="/categories/hexo/" class="animsition-link">hexo<small>(1)</small></a></li>
				    
				    <li><a href="/categories/noip离线赛/" class="animsition-link">noip离线赛<small>(2)</small></a></li>
				    
				    <li><a href="/categories/经验/" class="animsition-link">经验<small>(4)</small></a></li>
				    
				</ul>
        	</li>
			
            
            <li>
                <a class="sb-toggle-submenu">Links<span class="sb-caret"></span></a>
                <ul class="sb-submenu">
                    
                    <li><a href="http://go.kieran.top/" class="animsition-link">Kieran</a></li>
                    
                    <li><a href="http://domain.com/" class="animsition-link">Name</a></li>
                    
                    <li><a href="http://www.werelone.cn/" class="animsition-link">WERELONE</a></li>
                    
                </ul>
            </li>
            
        </ul>
        <!-- Lists in Slidebars -->
        <ul class="sb-menu secondary">
            <li><a href="/about.html" class="animsition-link" title="about">About</a></li>
            <li><a href="/atom.xml" class="animsition-link" title="rss">RSS</a></li>
        </ul>
    </div>
    
    <!-- ============================ END Off-canvas navigation =========================== -->

    <!-- ============================ #sb-site Main Page Wrapper =========================== -->

    <div id="sb-site">
        <!-- #sb-site - All page content should be contained within this id, except the off-canvas navigation itself -->

        <!-- ============================ Header & Logo bar =========================== -->

        <div id="navigation" class="navbar navbar-fixed-top">
            <div class="navbar-inner">
                <div class="container">
                    <!-- Nav logo -->
                    <div class="logo">
                        <a href="/" title="Logo" class="animsition-link">
                         <img src="/img/xx.png" alt="Logo" width="35px;"/> 
                        </a>
                    </div>
                    <!-- // Nav logo -->
                    <!-- Info-bar -->
                    <nav>
                        <ul class="nav">
                            <li><a href="/" class="animsition-link">yokel</a></li>
                            <li class="nolink"><span>Always </span>Creative.</li>
                            
                            <li><a href="https://github.com/" title="Github" target="_blank"><i class="icon-github"></i></a></li>
                            
                            
                            <li><a href="https://twitter.com/" title="Twitter" target="_blank"><i class="icon-twitter"></i></a></li>
                            
                            
                            <li><a href="https://www.facebook.com/" title="Facebook" target="_blank"><i class="icon-facebook"></i></a></li>
                            
                            
                            
                            <li class="nolink"><span>Welcome!</span></li>
                        </ul>
                    </nav>
                    <!--// Info-bar -->
                </div>
                <!-- // .container -->
                <div class="learnmore sb-toggle-right">More</div>
                <button type="button" class="navbar-toggle menu-icon sb-toggle-right" title="More">
                <span class="sr-only">Toggle navigation</span>
                <span class="icon-bar before"></span>
                <span class="icon-bar main"></span>
                <span class="icon-bar after"></span>
                </button>
            </div>
            <!-- // .navbar-inner -->
        </div>

        <!-- ============================ Header & Logo bar =========================== -->


      

<section id="intro">
    <div class="container">
        <div class="row col-md-offset-2">
            <div class="col-md-8">
    			<span class="post-meta">
      <time datetime="2017-08-13T02:21:49.671Z" itemprop="datePublished">
          2017-08-13
      </time>
    
</span>
                <h1>算法模板</h1>
            </div>
        </div>
        <div class="col-md-8 col-md-offset-2">
      		<h1 id="算法模板"><a href="#算法模板" class="headerlink" title="算法模板"></a>算法模板</h1><p>临近复赛，整理顺便复习一下之前学过的模板。。</p>
<h2 id="一-读入和输出"><a href="#一-读入和输出" class="headerlink" title="一.读入和输出"></a>一.读入和输出</h2><h3 id="1-文件读入输出"><a href="#1-文件读入输出" class="headerlink" title="1.文件读入输出"></a>1.文件读入输出</h3><figure class="highlight cpp"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div></pre></td><td class="code"><pre><div class="line">freopen(<span class="string">"文件名.in"</span>,<span class="string">"r"</span>,<span class="built_in">stdin</span>);</div><div class="line">freopen(<span class="string">"文件名.out"</span>,<span class="string">"w"</span>,<span class="built_in">stdout</span>);</div></pre></td></tr></table></figure>
<h4 id="使用freopen函数要头文件stdio-h，但没有不会在dev中报ce"><a href="#使用freopen函数要头文件stdio-h，但没有不会在dev中报ce" class="headerlink" title="使用freopen函数要头文件stdio.h，但没有不会在dev中报ce"></a>使用freopen函数要头文件stdio.h，但没有不会在dev中报ce</h4><h3 id="2-读入输出挂"><a href="#2-读入输出挂" class="headerlink" title="2.读入输出挂"></a>2.读入输出挂</h3><p>要加头文件ctype.h。</p>
<h4 id="读入"><a href="#读入" class="headerlink" title="读入"></a>读入</h4><figure class="highlight cpp"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div></pre></td><td class="code"><pre><div class="line"><span class="function"><span class="keyword">void</span> <span class="title">Rd</span><span class="params">(<span class="keyword">int</span> &amp;res)</span></span>&#123;</div><div class="line">	<span class="keyword">char</span> c;</div><div class="line">	<span class="keyword">int</span> k=<span class="number">1</span>;</div><div class="line">	res=<span class="number">0</span>;</div><div class="line">	<span class="keyword">while</span>(c=getchar(),!<span class="built_in">isdigit</span>(c)&amp;&amp;c!=<span class="string">'-'</span>);</div><div class="line">	<span class="keyword">if</span>(c==<span class="string">'-'</span>)k=<span class="number">-1</span>,c=getchar();</div><div class="line">	<span class="keyword">do</span>&#123;</div><div class="line">		res=(res&lt;&lt;<span class="number">3</span>)+(res&lt;&lt;<span class="number">1</span>)+(c^<span class="string">'0'</span>);</div><div class="line">	&#125;<span class="keyword">while</span>(c=getchar(),<span class="built_in">isdigit</span>(c));</div><div class="line">	res*=k;</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<h4 id="输出"><a href="#输出" class="headerlink" title="输出"></a>输出</h4><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div></pre></td><td class="code"><pre><div class="line">void Pt(int x)&#123;</div><div class="line">	if(!x)return;</div><div class="line">	Pt(x/10);</div><div class="line">	putchar(x%10^&apos;0&apos;);</div><div class="line">&#125;</div><div class="line">void Pf(int x)&#123;</div><div class="line">	if(x&lt;0)&#123;</div><div class="line">		putchar(&apos;-&apos;);</div><div class="line">		x=-x;</div><div class="line">	&#125;</div><div class="line">	if(x==0)putchar(&apos;0&apos;);</div><div class="line">	else Pt(x);</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<p>如果读入输出没有负数的话，最好把关于负数的都去掉，可以提高速度</p>
<h2 id="二-并查集"><a href="#二-并查集" class="headerlink" title="二.并查集"></a>二.并查集</h2><p>用途比较广，变法也比较多，主要用于集合。<br><figure class="highlight cpp"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">int</span> fa[M],h[M];</div><div class="line"><span class="function"><span class="keyword">int</span> <span class="title">getfa</span><span class="params">(<span class="keyword">int</span> x)</span></span>&#123;</div><div class="line">	<span class="keyword">if</span>(x==fa[x])<span class="keyword">return</span> x;</div><div class="line">	<span class="keyword">int</span> t=getfa(fa[x]);</div><div class="line">	h[x]+=h[fa[x]];</div><div class="line">	<span class="keyword">return</span> fa[x]=t;</div><div class="line">&#125;</div><div class="line"><span class="function"><span class="keyword">void</span> <span class="title">init</span><span class="params">()</span></span>&#123;</div><div class="line">	<span class="keyword">for</span>(<span class="keyword">int</span> i=<span class="number">1</span>;i&lt;=n;i++)fa[i]=i,h[i]=<span class="number">0</span>;</div><div class="line">&#125;</div><div class="line"><span class="function"><span class="keyword">void</span> <span class="title">merge</span><span class="params">(<span class="keyword">int</span> x,<span class="keyword">int</span> y)</span></span>&#123;</div><div class="line">	<span class="keyword">int</span> a=getfa(x);</div><div class="line">	<span class="keyword">int</span> b=getfa(y);</div><div class="line">	<span class="keyword">if</span>(a==b)<span class="keyword">return</span>;</div><div class="line">	<span class="keyword">if</span>(h[a]&gt;h[b])fa[b]=a;</div><div class="line">	<span class="keyword">else</span> <span class="keyword">if</span>(h[a]&lt;h[b])fa[a]=b;</div><div class="line">&#125;</div></pre></td></tr></table></figure></p>
<p><del>一开始写错，居然被Spylft嘲讽成傻逼并查集。。。</del></p>
<h2 id="三-最短路"><a href="#三-最短路" class="headerlink" title="三.最短路"></a>三.最短路</h2><h3 id="1-Dijkstra算法"><a href="#1-Dijkstra算法" class="headerlink" title="1.Dijkstra算法"></a>1.Dijkstra算法</h3><p>用堆来维护，每次弹出最小未被标记过的，遇到终点就直接返回，不能包含负边。<br><figure class="highlight cpp"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div><div class="line">35</div><div class="line">36</div><div class="line">37</div><div class="line">38</div><div class="line">39</div><div class="line">40</div><div class="line">41</div><div class="line">42</div><div class="line">43</div><div class="line">44</div><div class="line">45</div><div class="line">46</div><div class="line">47</div><div class="line">48</div><div class="line">49</div><div class="line">50</div><div class="line">51</div><div class="line">52</div><div class="line">53</div><div class="line">54</div><div class="line">55</div><div class="line">56</div></pre></td><td class="code"><pre><div class="line"><span class="meta">#<span class="meta-keyword">include</span><span class="meta-string">&lt;stdio.h&gt;</span></span></div><div class="line"><span class="meta">#<span class="meta-keyword">include</span><span class="meta-string">&lt;iostream&gt;</span></span></div><div class="line"><span class="meta">#<span class="meta-keyword">include</span><span class="meta-string">&lt;algorithm&gt;</span></span></div><div class="line"><span class="meta">#<span class="meta-keyword">include</span><span class="meta-string">&lt;queue&gt;</span></span></div><div class="line"><span class="meta">#<span class="meta-keyword">include</span><span class="meta-string">&lt;vector&gt;</span></span></div><div class="line"><span class="meta">#<span class="meta-keyword">define</span> M 10005</span></div><div class="line"><span class="meta">#<span class="meta-keyword">define</span> oo 2000000000</span></div><div class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> <span class="built_in">std</span>;</div><div class="line"><span class="class"><span class="keyword">struct</span> <span class="title">node</span>&#123;</span></div><div class="line">	<span class="keyword">int</span> v,to;</div><div class="line">	<span class="keyword">bool</span> <span class="keyword">operator</span> &lt;(<span class="keyword">const</span> node &amp;p)<span class="keyword">const</span>&#123;</div><div class="line">		<span class="keyword">return</span> v&gt;p.v;</div><div class="line">	&#125;</div><div class="line">&#125;;</div><div class="line"><span class="built_in">vector</span>&lt;node&gt;edge[M];</div><div class="line">priority_queue&lt;node&gt;Q;</div><div class="line"><span class="keyword">bool</span> mark[M];</div><div class="line"><span class="keyword">int</span> n,dis[M];</div><div class="line"><span class="function"><span class="keyword">int</span> <span class="title">djs</span><span class="params">(<span class="keyword">int</span> s,<span class="keyword">int</span> e)</span></span>&#123;</div><div class="line">	<span class="keyword">while</span>(!Q.empty())Q.pop();</div><div class="line">	<span class="keyword">for</span>(<span class="keyword">int</span> i=<span class="number">1</span>;i&lt;=n;i++)dis[i]=oo;</div><div class="line">	node st;</div><div class="line">	st.v=<span class="number">0</span>,st.to=s;</div><div class="line">	Q.push(st);</div><div class="line">	dis[s]=<span class="number">0</span>;</div><div class="line">	<span class="keyword">while</span>(!Q.empty())&#123;</div><div class="line">		node now=Q.top();Q.pop();</div><div class="line">		<span class="keyword">int</span> p=now.to;</div><div class="line">		<span class="keyword">if</span>(mark[p])<span class="keyword">continue</span>;</div><div class="line">		mark[p]=<span class="number">1</span>;</div><div class="line">		<span class="keyword">if</span>(p==e)<span class="keyword">return</span> now.v;</div><div class="line">		<span class="keyword">for</span>(<span class="keyword">int</span> i=<span class="number">0</span>;i&lt;edge[p].size();i++)&#123;</div><div class="line">			node pp=edge[p][i];</div><div class="line">			<span class="keyword">if</span>(mark[pp.to])<span class="keyword">continue</span>;</div><div class="line">			<span class="keyword">if</span>(pp.v+now.v&lt;dis[pp.to])&#123;</div><div class="line">				dis[pp.to]=pp.v+now.v;</div><div class="line">				node nxt;</div><div class="line">				nxt.to=pp.to,nxt.v=dis[pp.to];</div><div class="line">				Q.push(nxt);</div><div class="line">			&#125;</div><div class="line">		&#125;</div><div class="line">	&#125;</div><div class="line">	<span class="keyword">return</span> <span class="number">-1</span>;</div><div class="line">&#125;</div><div class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span></span>&#123;</div><div class="line">	<span class="keyword">int</span> m,s,e,i,k,j,x,y,z;</div><div class="line">	<span class="built_in">scanf</span>(<span class="string">"%d%d%d%d"</span>,&amp;n,&amp;m,&amp;s,&amp;e);</div><div class="line">	<span class="keyword">for</span>(i=<span class="number">1</span>;i&lt;=m;i++)&#123;</div><div class="line">		<span class="built_in">scanf</span>(<span class="string">"%d%d%d"</span>,&amp;x,&amp;y,&amp;z);</div><div class="line">		node now;</div><div class="line">		now.v=z,now.to=y;</div><div class="line">		edge[x].push_back(now);</div><div class="line">	&#125;</div><div class="line">	<span class="built_in">printf</span>(<span class="string">"%d\n"</span>,djs(s,e));</div><div class="line">	<span class="keyword">return</span> <span class="number">0</span>;</div><div class="line">&#125;</div></pre></td></tr></table></figure></p>
<h3 id="2-floyd算法"><a href="#2-floyd算法" class="headerlink" title="2.floyd算法"></a>2.floyd算法</h3><p>多源点最短路，但是对时间和空间都是很大的消耗，感觉大部分情况没有其他最短路算法好用，可以包含负边。<br><figure class="highlight cpp"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div></pre></td><td class="code"><pre><div class="line"><span class="meta">#<span class="meta-keyword">include</span><span class="meta-string">&lt;stdio.h&gt;</span></span></div><div class="line"><span class="meta">#<span class="meta-keyword">include</span><span class="meta-string">&lt;iostream&gt;</span></span></div><div class="line"><span class="meta">#<span class="meta-keyword">include</span><span class="meta-string">&lt;algorithm&gt;</span></span></div><div class="line"><span class="meta">#<span class="meta-keyword">define</span> M 10005</span></div><div class="line"><span class="meta">#<span class="meta-keyword">define</span> oo 1000000000</span></div><div class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> <span class="built_in">std</span>;</div><div class="line"><span class="keyword">int</span> dis[M][M];</div><div class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span></span>&#123;</div><div class="line">	<span class="keyword">int</span> n,m,i,k,j,s,e,x,y,z;</div><div class="line">	<span class="built_in">scanf</span>(<span class="string">"%d%d%d%d"</span>,&amp;n,&amp;m,&amp;s,&amp;e);</div><div class="line">	<span class="keyword">for</span>(i=<span class="number">1</span>;i&lt;=n;i++)&#123;</div><div class="line">		<span class="keyword">for</span>(k=<span class="number">1</span>;k&lt;=n;k++)&#123;</div><div class="line">			dis[i][k]=oo;</div><div class="line">		&#125;</div><div class="line">	&#125;</div><div class="line">	<span class="keyword">for</span>(i=<span class="number">1</span>;i&lt;=m;i++)&#123;</div><div class="line">		<span class="built_in">scanf</span>(<span class="string">"%d%d%d"</span>,&amp;x,&amp;y,&amp;z);</div><div class="line">		dis[x][y]=min(dis[x][y],z);</div><div class="line">	&#125;</div><div class="line">	<span class="keyword">for</span>(i=<span class="number">1</span>;i&lt;=n;i++)&#123;</div><div class="line">		<span class="keyword">for</span>(k=<span class="number">1</span>;k&lt;=n;k++)&#123;</div><div class="line">			<span class="keyword">if</span>(k==i)<span class="keyword">continue</span>;</div><div class="line">			<span class="keyword">for</span>(j=<span class="number">1</span>;j&lt;=n;j++)&#123;</div><div class="line">				<span class="keyword">if</span>(k==j||j==i)<span class="keyword">continue</span>;</div><div class="line">				dis[k][j]=min(dis[k][j],dis[k][i]+dis[i][j]);</div><div class="line">			&#125;</div><div class="line">		&#125;</div><div class="line">	&#125;</div><div class="line">	<span class="keyword">if</span>(dis[s][e]==oo)dis[s][e]=<span class="number">-1</span>;</div><div class="line">	<span class="built_in">printf</span>(<span class="string">"%d\n"</span>,dis[s][e]);</div><div class="line">	<span class="keyword">return</span> <span class="number">0</span>;</div><div class="line">&#125;</div></pre></td></tr></table></figure></p>
<h3 id="3-bellman-ford算法"><a href="#3-bellman-ford算法" class="headerlink" title="3.bellman-ford算法"></a>3.bellman-ford算法</h3><p>感觉比较暴力，就是让所有点不断更新自己能更新的最小值，直到不能更新为止，可以包含负边。<br><figure class="highlight cpp"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div><div class="line">35</div><div class="line">36</div><div class="line">37</div><div class="line">38</div><div class="line">39</div><div class="line">40</div><div class="line">41</div><div class="line">42</div></pre></td><td class="code"><pre><div class="line"><span class="meta">#<span class="meta-keyword">include</span><span class="meta-string">&lt;stdio.h&gt;</span></span></div><div class="line"><span class="meta">#<span class="meta-keyword">include</span><span class="meta-string">&lt;iostream&gt;</span></span></div><div class="line"><span class="meta">#<span class="meta-keyword">include</span><span class="meta-string">&lt;algorithm&gt;</span></span></div><div class="line"><span class="meta">#<span class="meta-keyword">include</span><span class="meta-string">&lt;vector&gt;</span></span></div><div class="line"><span class="meta">#<span class="meta-keyword">define</span> oo 2000000000</span></div><div class="line"><span class="meta">#<span class="meta-keyword">define</span> M 10005</span></div><div class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> <span class="built_in">std</span>;</div><div class="line"><span class="class"><span class="keyword">struct</span> <span class="title">node</span>&#123;</span><span class="keyword">int</span> v,to;&#125;;</div><div class="line"><span class="built_in">vector</span>&lt;node&gt;edge[M];</div><div class="line"><span class="keyword">int</span> n,m,dis[M];</div><div class="line"><span class="function"><span class="keyword">void</span> <span class="title">bellmanford</span><span class="params">(<span class="keyword">int</span> s,<span class="keyword">int</span> e)</span></span>&#123;</div><div class="line">	<span class="keyword">for</span>(<span class="keyword">int</span> i=<span class="number">1</span>;i&lt;=n;i++)dis[i]=oo;</div><div class="line">	dis[s]=<span class="number">0</span>;</div><div class="line">	<span class="keyword">while</span>(<span class="number">1</span>)&#123;</div><div class="line">		<span class="keyword">bool</span> stop=<span class="number">1</span>;</div><div class="line">		<span class="keyword">for</span>(<span class="keyword">int</span> i=<span class="number">1</span>;i&lt;=n;i++)&#123;</div><div class="line">			<span class="keyword">if</span>(dis[i]==oo)<span class="keyword">continue</span>;</div><div class="line">			<span class="keyword">for</span>(<span class="keyword">int</span> k=<span class="number">0</span>;k&lt;edge[i].size();k++)&#123;</div><div class="line">				node p=edge[i][k];</div><div class="line">				<span class="keyword">if</span>(dis[i]+p.v&lt;dis[p.to])&#123;</div><div class="line">					dis[p.to]=dis[i]+p.v;</div><div class="line">					stop=<span class="number">0</span>;</div><div class="line">				&#125;</div><div class="line">			&#125;</div><div class="line">		&#125;</div><div class="line">		<span class="keyword">if</span>(stop)<span class="keyword">break</span>;</div><div class="line">	&#125;</div><div class="line">&#125;</div><div class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span></span>&#123;</div><div class="line">	<span class="keyword">int</span> i,k,j,x,y,z,s,e;</div><div class="line">	<span class="built_in">scanf</span>(<span class="string">"%d%d%d%d"</span>,&amp;n,&amp;m,&amp;s,&amp;e);</div><div class="line">	<span class="keyword">for</span>(i=<span class="number">1</span>;i&lt;=m;i++)&#123;</div><div class="line">		<span class="built_in">scanf</span>(<span class="string">"%d%d%d"</span>,&amp;x,&amp;y,&amp;z);</div><div class="line">		node now;</div><div class="line">		now.to=y,now.v=z;</div><div class="line">		edge[x].push_back(now);</div><div class="line">	&#125;</div><div class="line">	bellmanford(s,e);</div><div class="line">	<span class="keyword">if</span>(dis[e]==oo)dis[e]=<span class="number">-1</span>;</div><div class="line">	<span class="built_in">printf</span>(<span class="string">"%d"</span>,dis[e]);</div><div class="line">	<span class="keyword">return</span> <span class="number">0</span>;</div><div class="line">&#125;</div></pre></td></tr></table></figure></p>
<h3 id="4-SPFA算法"><a href="#4-SPFA算法" class="headerlink" title="4.SPFA算法"></a>4.SPFA算法</h3><p>据说一般比较快，但是在特定数据下会被卡得很惨，可以包含负边。和bellman­ford比较像，但是存入队列，如果<br>已经在队列中就不入队。<br><figure class="highlight cpp"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div><div class="line">35</div><div class="line">36</div><div class="line">37</div><div class="line">38</div><div class="line">39</div><div class="line">40</div><div class="line">41</div><div class="line">42</div><div class="line">43</div><div class="line">44</div><div class="line">45</div><div class="line">46</div><div class="line">47</div><div class="line">48</div></pre></td><td class="code"><pre><div class="line"><span class="meta">#<span class="meta-keyword">include</span><span class="meta-string">&lt;stdio.h&gt;</span></span></div><div class="line"><span class="meta">#<span class="meta-keyword">include</span><span class="meta-string">&lt;iostream&gt;</span></span></div><div class="line"><span class="meta">#<span class="meta-keyword">include</span><span class="meta-string">&lt;algorithm&gt;</span></span></div><div class="line"><span class="meta">#<span class="meta-keyword">include</span><span class="meta-string">&lt;vector&gt;</span></span></div><div class="line"><span class="meta">#<span class="meta-keyword">define</span> oo 2000000000</span></div><div class="line"><span class="meta">#<span class="meta-keyword">define</span> M 10005</span></div><div class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> <span class="built_in">std</span>;</div><div class="line"><span class="class"><span class="keyword">struct</span> <span class="title">node</span>&#123;</span><span class="keyword">int</span> v,to;&#125;;</div><div class="line"><span class="built_in">vector</span>&lt;node&gt;edge[M];</div><div class="line"><span class="keyword">int</span> n,m,dis[M];</div><div class="line"><span class="keyword">int</span> dui[M*<span class="number">5</span>];</div><div class="line"><span class="keyword">bool</span> mark[M];</div><div class="line"><span class="function"><span class="keyword">void</span> <span class="title">SPFA</span><span class="params">(<span class="keyword">int</span> s,<span class="keyword">int</span> e)</span></span>&#123;</div><div class="line">	<span class="keyword">for</span>(<span class="keyword">int</span> i=<span class="number">1</span>;i&lt;=n;i++)&#123;</div><div class="line">		mark[i]=<span class="number">0</span>,dis[i]=oo;</div><div class="line">	&#125;</div><div class="line">	mark[s]=<span class="number">1</span>,dis[s]=<span class="number">0</span>;</div><div class="line">	<span class="keyword">int</span> L=<span class="number">0</span>,R=<span class="number">-1</span>;</div><div class="line">	dui[++R]=s;</div><div class="line">	<span class="keyword">while</span>(L&lt;=R)&#123;</div><div class="line">		<span class="keyword">int</span> now=dui[L++];</div><div class="line">		mark[now]=<span class="number">0</span>;</div><div class="line">		<span class="keyword">for</span>(<span class="keyword">int</span> i=<span class="number">0</span>;i&lt;edge[now].size();i++)&#123;</div><div class="line">			node p=edge[now][i];</div><div class="line">			<span class="keyword">if</span>(dis[now]+p.v&lt;dis[p.to])&#123;</div><div class="line">				dis[p.to]=dis[now]+p.v;</div><div class="line">				<span class="keyword">if</span>(!mark[p.to])&#123;</div><div class="line">					mark[p.to]=<span class="number">1</span>;</div><div class="line">					dui[++R]=p.to;</div><div class="line">				&#125;</div><div class="line">			&#125;</div><div class="line">		&#125;</div><div class="line">	&#125;</div><div class="line">&#125;</div><div class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span></span>&#123;	</div><div class="line">	<span class="keyword">int</span> i,k,j,x,y,z,s,e;</div><div class="line">	<span class="built_in">scanf</span>(<span class="string">"%d%d%d%d"</span>,&amp;n,&amp;m,&amp;s,&amp;e);</div><div class="line">	<span class="keyword">for</span>(i=<span class="number">1</span>;i&lt;=m;i++)&#123;</div><div class="line">		<span class="built_in">scanf</span>(<span class="string">"%d%d%d"</span>,&amp;x,&amp;y,&amp;z);</div><div class="line">		node now;</div><div class="line">		now.to=y,now.v=z;</div><div class="line">		edge[x].push_back(now);</div><div class="line">	&#125;</div><div class="line">	SPFA(s,e);</div><div class="line">	<span class="keyword">if</span>(dis[e]==oo)dis[e]=<span class="number">-1</span>;</div><div class="line">	<span class="built_in">printf</span>(<span class="string">"%d\n"</span>,dis[e]);</div><div class="line">	<span class="keyword">return</span> <span class="number">0</span>;</div><div class="line">&#125;</div></pre></td></tr></table></figure></p>
<h2 id="四-最小生成树"><a href="#四-最小生成树" class="headerlink" title="四.最小生成树"></a>四.最小生成树</h2><h3 id="1-Prim算法"><a href="#1-Prim算法" class="headerlink" title="1.Prim算法"></a>1.Prim算法</h3><p>从任意一个点开始，然后每次取花费最小能更新的点，把该点能更新的也放入队列，重复直到所有点都在树上。<br><figure class="highlight cpp"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div><div class="line">35</div><div class="line">36</div><div class="line">37</div><div class="line">38</div><div class="line">39</div><div class="line">40</div><div class="line">41</div><div class="line">42</div><div class="line">43</div><div class="line">44</div><div class="line">45</div><div class="line">46</div><div class="line">47</div><div class="line">48</div><div class="line">49</div><div class="line">50</div></pre></td><td class="code"><pre><div class="line"><span class="meta">#<span class="meta-keyword">include</span><span class="meta-string">&lt;stdio.h&gt;</span></span></div><div class="line"><span class="meta">#<span class="meta-keyword">include</span><span class="meta-string">&lt;iostream&gt;</span></span></div><div class="line"><span class="meta">#<span class="meta-keyword">include</span><span class="meta-string">&lt;algorithm&gt;</span></span></div><div class="line"><span class="meta">#<span class="meta-keyword">include</span><span class="meta-string">&lt;vector&gt;</span></span></div><div class="line"><span class="meta">#<span class="meta-keyword">include</span><span class="meta-string">&lt;queue&gt;</span></span></div><div class="line"><span class="meta">#<span class="meta-keyword">define</span> oo 2000000000</span></div><div class="line"><span class="meta">#<span class="meta-keyword">define</span> M 10005</span></div><div class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> <span class="built_in">std</span>;</div><div class="line"><span class="class"><span class="keyword">struct</span> <span class="title">node</span>&#123;</span></div><div class="line">	<span class="keyword">int</span> to,v;</div><div class="line">	<span class="keyword">bool</span> <span class="keyword">operator</span> &lt;(<span class="keyword">const</span> node &amp;p)<span class="keyword">const</span>&#123;</div><div class="line">		<span class="keyword">return</span> v&gt;p.v;</div><div class="line">	&#125;</div><div class="line">&#125;;</div><div class="line"><span class="built_in">vector</span>&lt;node&gt;edge[M];</div><div class="line">priority_queue&lt;node&gt;Q;</div><div class="line"><span class="keyword">bool</span> mark[M]=&#123;<span class="number">0</span>&#125;;</div><div class="line"><span class="keyword">int</span> ans=<span class="number">0</span>,m,n;</div><div class="line"><span class="function"><span class="keyword">void</span> <span class="title">Prim</span><span class="params">()</span></span>&#123;</div><div class="line">	node st;</div><div class="line">	st.to=<span class="number">1</span>,st.v=<span class="number">0</span>;</div><div class="line">	<span class="keyword">int</span> cnt=<span class="number">1</span>;</div><div class="line">	Q.push(st);</div><div class="line">	<span class="keyword">while</span>(!Q.empty())&#123;</div><div class="line">		node now=Q.top();Q.pop();</div><div class="line">		<span class="keyword">if</span>(mark[now.to])<span class="keyword">continue</span>;</div><div class="line">		mark[now.to]=<span class="number">1</span>;</div><div class="line">		ans+=now.v,cnt++;</div><div class="line">		<span class="keyword">for</span>(<span class="keyword">int</span> i=<span class="number">0</span>;i&lt;edge[now.to].size();i++)&#123;</div><div class="line">			node nxt;</div><div class="line">			nxt.to=edge[now.to][i].to,nxt.v=edge[now.to][i].v;</div><div class="line">			Q.push(nxt);</div><div class="line">		&#125;</div><div class="line">	&#125;</div><div class="line">&#125;</div><div class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span></span>&#123;</div><div class="line">	<span class="keyword">int</span> i,k,j,x,y,z;</div><div class="line">	<span class="built_in">scanf</span>(<span class="string">"%d%d"</span>,&amp;n,&amp;m);</div><div class="line">	<span class="keyword">for</span>(i=<span class="number">1</span>;i&lt;=m;i++)&#123;</div><div class="line">		<span class="built_in">scanf</span>(<span class="string">"%d%d%d"</span>,&amp;x,&amp;y,&amp;z);</div><div class="line">		node now;</div><div class="line">		now.to=y,now.v=z;</div><div class="line">		edge[x].push_back(now);</div><div class="line">		now.to=x;</div><div class="line">		edge[y].push_back(now);</div><div class="line">	&#125;</div><div class="line">	Prim();</div><div class="line">	<span class="built_in">printf</span>(<span class="string">"%d"</span>,ans);</div><div class="line">	<span class="keyword">return</span> <span class="number">0</span>;</div><div class="line">&#125;</div></pre></td></tr></table></figure></p>
<h3 id="2-Kruskal算法"><a href="#2-Kruskal算法" class="headerlink" title="2.Kruskal算法"></a>2.Kruskal算法</h3><p>将每条边按权值小排序，用并查集逐渐将所有点都合并到一个集合中。<br><figure class="highlight cpp"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div></pre></td><td class="code"><pre><div class="line"><span class="meta">#<span class="meta-keyword">include</span><span class="meta-string">&lt;stdio.h&gt;</span></span></div><div class="line"><span class="meta">#<span class="meta-keyword">include</span><span class="meta-string">&lt;iostream&gt;</span></span></div><div class="line"><span class="meta">#<span class="meta-keyword">include</span><span class="meta-string">&lt;algorithm&gt;</span></span></div><div class="line"><span class="meta">#<span class="meta-keyword">define</span> M 100005</span></div><div class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> <span class="built_in">std</span>;</div><div class="line"><span class="class"><span class="keyword">struct</span> <span class="title">node</span>&#123;</span><span class="keyword">int</span> x,y,v;&#125;edge[M];</div><div class="line"><span class="function"><span class="keyword">bool</span> <span class="title">cmp</span><span class="params">(node a,node b)</span></span>&#123;</div><div class="line">	<span class="keyword">return</span> a.v&lt;b.v;</div><div class="line">&#125;</div><div class="line"><span class="keyword">int</span> fa[M];</div><div class="line"><span class="function"><span class="keyword">int</span> <span class="title">getfa</span><span class="params">(<span class="keyword">int</span> x)</span></span>&#123;</div><div class="line">	<span class="keyword">if</span>(fa[x]==x)<span class="keyword">return</span> x;</div><div class="line">	<span class="keyword">return</span> fa[x]=getfa(fa[x]);</div><div class="line">&#125;</div><div class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span></span>&#123;</div><div class="line">	<span class="keyword">int</span> n,m,i,k,j,ans=<span class="number">0</span>;</div><div class="line">	<span class="built_in">scanf</span>(<span class="string">"%d%d"</span>,&amp;n,&amp;m);</div><div class="line">	<span class="keyword">for</span>(i=<span class="number">1</span>;i&lt;=m;i++)<span class="built_in">scanf</span>(<span class="string">"%d%d%d"</span>,&amp;edge[i].x,&amp;edge[i].y,&amp;edge[i].v);</div><div class="line">	sort(edge+<span class="number">1</span>,edge+<span class="number">1</span>+m,cmp);</div><div class="line">	<span class="keyword">for</span>(i=<span class="number">1</span>;i&lt;=n;i++)fa[i]=i;</div><div class="line">	<span class="keyword">for</span>(i=<span class="number">1</span>;i&lt;=m;i++)&#123;</div><div class="line">		<span class="keyword">int</span> a=getfa(edge[i].x);</div><div class="line">		<span class="keyword">int</span> b=getfa(edge[i].y);</div><div class="line">		<span class="keyword">if</span>(a!=b)&#123;</div><div class="line">			fa[a]=fa[b];</div><div class="line">			ans+=edge[i].v;</div><div class="line">		&#125;</div><div class="line">	&#125;</div><div class="line">	<span class="built_in">printf</span>(<span class="string">"%d"</span>,ans);</div><div class="line">	<span class="keyword">return</span> <span class="number">0</span>;</div><div class="line">&#125;</div></pre></td></tr></table></figure></p>
<h2 id="五-强连通"><a href="#五-强连通" class="headerlink" title="五.强连通"></a>五.强连通</h2><figure class="highlight cpp"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div><div class="line">35</div><div class="line">36</div><div class="line">37</div><div class="line">38</div><div class="line">39</div><div class="line">40</div><div class="line">41</div><div class="line">42</div><div class="line">43</div><div class="line">44</div><div class="line">45</div><div class="line">46</div><div class="line">47</div><div class="line">48</div><div class="line">49</div><div class="line">50</div><div class="line">51</div><div class="line">52</div><div class="line">53</div></pre></td><td class="code"><pre><div class="line"><span class="meta">#<span class="meta-keyword">include</span><span class="meta-string">&lt;stdio.h&gt;</span></span></div><div class="line"><span class="meta">#<span class="meta-keyword">include</span><span class="meta-string">&lt;iostream&gt;</span></span></div><div class="line"><span class="meta">#<span class="meta-keyword">include</span><span class="meta-string">&lt;algorithm&gt;</span></span></div><div class="line"><span class="meta">#<span class="meta-keyword">include</span><span class="meta-string">&lt;vector&gt;</span></span></div><div class="line"><span class="meta">#<span class="meta-keyword">include</span><span class="meta-string">&lt;string.h&gt;</span></span></div><div class="line"><span class="meta">#<span class="meta-keyword">define</span> M 55</span></div><div class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> <span class="built_in">std</span>;</div><div class="line"><span class="built_in">vector</span>&lt;<span class="keyword">int</span>&gt;vs,sedge[M],redge[M],block[M],edge[M];</div><div class="line"><span class="keyword">int</span> n,sz=<span class="number">0</span>,id[M];</div><div class="line"><span class="keyword">bool</span> used[M];</div><div class="line"><span class="function"><span class="keyword">void</span> <span class="title">dfs</span><span class="params">(<span class="keyword">int</span> now)</span></span>&#123;</div><div class="line">	used[now]=<span class="number">1</span>;</div><div class="line">	<span class="keyword">for</span>(<span class="keyword">int</span> i=<span class="number">0</span>;i&lt;sedge[now].size();i++)&#123;</div><div class="line">		<span class="keyword">int</span> p=sedge[now][i];</div><div class="line">		<span class="keyword">if</span>(!used[p])dfs(p);</div><div class="line">	&#125;</div><div class="line">	vs.push_back(now);</div><div class="line">&#125;</div><div class="line"><span class="function"><span class="keyword">void</span> <span class="title">rdfs</span><span class="params">(<span class="keyword">int</span> now,<span class="keyword">int</span> num)</span></span>&#123;</div><div class="line">	id[now]=num;</div><div class="line">	used[now]=<span class="number">1</span>;</div><div class="line">	block[num].push_back(now);</div><div class="line">	<span class="keyword">for</span>(<span class="keyword">int</span> i=<span class="number">0</span>;i&lt;redge[now].size();i++)&#123;</div><div class="line">		<span class="keyword">int</span> p=redge[now][i];</div><div class="line">		<span class="keyword">if</span>(!used[p])rdfs(p,num);</div><div class="line">	&#125;</div><div class="line">&#125;</div><div class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span></span>&#123;</div><div class="line">	<span class="keyword">int</span> x,y;</div><div class="line">	<span class="built_in">scanf</span>(<span class="string">"%d"</span>,&amp;n);</div><div class="line">	<span class="keyword">for</span>(<span class="keyword">int</span> i=<span class="number">1</span>;i&lt;=n;i++)&#123;</div><div class="line">		<span class="built_in">scanf</span>(<span class="string">"%d%d"</span>,&amp;x,&amp;y);</div><div class="line">		sedge[x].push_back(y);</div><div class="line">		redge[y].push_back(x);</div><div class="line">	&#125;</div><div class="line">	<span class="keyword">for</span>(<span class="keyword">int</span> i=<span class="number">0</span>;i&lt;n;i++)&#123;</div><div class="line">		<span class="keyword">if</span>(!used[i])dfs(i);</div><div class="line">	&#125;</div><div class="line">	<span class="built_in">memset</span>(used,<span class="number">0</span>,<span class="keyword">sizeof</span>(used));</div><div class="line">	<span class="keyword">for</span>(<span class="keyword">int</span> i=n<span class="number">-1</span>;i&gt;=<span class="number">0</span>;i--)&#123;</div><div class="line">		<span class="keyword">if</span>(!used[vs[i]])rdfs(i,++sz);</div><div class="line">	&#125;</div><div class="line">	<span class="keyword">for</span>(<span class="keyword">int</span> i=<span class="number">1</span>;i&lt;=sz;i++)&#123;</div><div class="line">		<span class="keyword">for</span>(<span class="keyword">int</span> k=<span class="number">0</span>;k&lt;block[i].size();k++)&#123;</div><div class="line">			<span class="keyword">int</span> now=block[i][k];</div><div class="line">			<span class="keyword">for</span>(<span class="keyword">int</span> j=<span class="number">0</span>;j&lt;sedge[now].size();j++)&#123;</div><div class="line">				<span class="keyword">int</span> p=id[sedge[now][j]];</div><div class="line">				<span class="keyword">if</span>(p!=i)edge[i].push_back(p);</div><div class="line">			&#125;</div><div class="line">		&#125;</div><div class="line">	&#125;</div><div class="line">	<span class="keyword">return</span> <span class="number">0</span>;</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<h2 id="六-关于树"><a href="#六-关于树" class="headerlink" title="六.关于树"></a>六.关于树</h2><h3 id="1-最小公共祖先（LCA）"><a href="#1-最小公共祖先（LCA）" class="headerlink" title="1.最小公共祖先（LCA）"></a>1.最小公共祖先（LCA）</h3><h4 id="倍增"><a href="#倍增" class="headerlink" title="倍增"></a>倍增</h4><figure class="highlight cpp"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div><div class="line">35</div><div class="line">36</div><div class="line">37</div><div class="line">38</div><div class="line">39</div><div class="line">40</div><div class="line">41</div><div class="line">42</div><div class="line">43</div><div class="line">44</div><div class="line">45</div><div class="line">46</div><div class="line">47</div><div class="line">48</div><div class="line">49</div><div class="line">50</div><div class="line">51</div><div class="line">52</div><div class="line">53</div><div class="line">54</div><div class="line">55</div><div class="line">56</div></pre></td><td class="code"><pre><div class="line"><span class="meta">#<span class="meta-keyword">include</span><span class="meta-string">&lt;stdio.h&gt;</span></span></div><div class="line"><span class="meta">#<span class="meta-keyword">include</span><span class="meta-string">&lt;iostream&gt;</span></span></div><div class="line"><span class="meta">#<span class="meta-keyword">include</span><span class="meta-string">&lt;vector&gt;</span></span></div><div class="line"><span class="meta">#<span class="meta-keyword">include</span><span class="meta-string">&lt;algorithm&gt;</span></span></div><div class="line"><span class="meta">#<span class="meta-keyword">define</span> M 100005</span></div><div class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> <span class="built_in">std</span>;</div><div class="line"><span class="built_in">vector</span>&lt;<span class="keyword">int</span>&gt;edge[M];</div><div class="line"><span class="keyword">int</span> n,jump[<span class="number">20</span>][M],dep[M],S=<span class="number">0</span>;</div><div class="line"><span class="function"><span class="keyword">void</span> <span class="title">makedfs</span><span class="params">(<span class="keyword">int</span> now,<span class="keyword">int</span> las,<span class="keyword">int</span> deep)</span></span>&#123;</div><div class="line">	jump[<span class="number">0</span>][now]=las,dep[now]=deep;</div><div class="line">	<span class="keyword">for</span>(<span class="keyword">int</span> i=<span class="number">0</span>;i&lt;edge[now].size();i++)&#123;</div><div class="line">		<span class="keyword">int</span> p=edge[now][i];</div><div class="line">		<span class="keyword">if</span>(p==las)<span class="keyword">continue</span>;</div><div class="line">		makedfs(p,now,deep+<span class="number">1</span>);</div><div class="line">	&#125;</div><div class="line">&#125;</div><div class="line"><span class="function"><span class="keyword">void</span> <span class="title">makejump</span><span class="params">()</span></span>&#123;</div><div class="line">	<span class="keyword">int</span> x=<span class="number">1</span>;</div><div class="line">	<span class="keyword">while</span>(x&lt;=n)x&lt;&lt;=<span class="number">1</span>,S++;</div><div class="line">	S--;</div><div class="line">	<span class="keyword">for</span>(<span class="keyword">int</span> i=<span class="number">0</span>;i&lt;S;i++)&#123;</div><div class="line">		<span class="keyword">for</span>(<span class="keyword">int</span> k=<span class="number">1</span>;k&lt;=n;k++)&#123;</div><div class="line">			<span class="keyword">if</span>(jump[i][k]==<span class="number">-1</span>)jump[i+<span class="number">1</span>][k]=<span class="number">-1</span>;</div><div class="line">			<span class="keyword">else</span> jump[i+<span class="number">1</span>][k]=jump[i][jump[i][k]];</div><div class="line">		&#125;</div><div class="line">	&#125;</div><div class="line">&#125;</div><div class="line"><span class="function"><span class="keyword">int</span> <span class="title">LCA</span><span class="params">(<span class="keyword">int</span> x,<span class="keyword">int</span> y)</span></span>&#123;</div><div class="line">	<span class="keyword">if</span>(dep[x]&gt;dep[y])swap(x,y);</div><div class="line">	<span class="keyword">int</span> a=dep[y]-dep[x];</div><div class="line">	<span class="keyword">for</span>(<span class="keyword">int</span> i=<span class="number">0</span>;i&lt;=S;i++)&#123;</div><div class="line">		<span class="keyword">if</span>(a&amp;<span class="number">1</span>)y=jump[i][y];</div><div class="line">		a&gt;&gt;=<span class="number">1</span>;</div><div class="line">	&#125;</div><div class="line">	<span class="keyword">if</span>(x==y)<span class="keyword">return</span> x;</div><div class="line">	<span class="keyword">for</span>(<span class="keyword">int</span> i=S;i&gt;=<span class="number">0</span>;i--)&#123;</div><div class="line">		<span class="keyword">if</span>(jump[i][x]!=jump[i][y])x=jump[i][x],y=jump[i][y];</div><div class="line">	&#125;</div><div class="line">	<span class="keyword">return</span> jump[<span class="number">0</span>][x];</div><div class="line">&#125;</div><div class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span></span>&#123;</div><div class="line">	<span class="keyword">int</span> m,i,k,j,x,y;</div><div class="line">	<span class="built_in">scanf</span>(<span class="string">"%d%d"</span>,&amp;n,&amp;m);</div><div class="line">	<span class="keyword">for</span>(i=<span class="number">1</span>;i&lt;n;i++)&#123;</div><div class="line">		<span class="built_in">scanf</span>(<span class="string">"%d%d"</span>,&amp;x,&amp;y);</div><div class="line">		edge[x].push_back(y);</div><div class="line">		edge[y].push_back(x);</div><div class="line">	&#125;</div><div class="line">	makedfs(<span class="number">1</span>,<span class="number">-1</span>,<span class="number">0</span>);</div><div class="line">	makejump();</div><div class="line">	<span class="keyword">for</span>(i=<span class="number">1</span>;i&lt;=m;i++)&#123;</div><div class="line">		<span class="built_in">scanf</span>(<span class="string">"%d%d"</span>,&amp;x,&amp;y);</div><div class="line">		<span class="built_in">printf</span>(<span class="string">"%d\n"</span>,LCA(x,y));</div><div class="line">	&#125;</div><div class="line">	<span class="keyword">return</span> <span class="number">0</span>;</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<h4 id="树链剖分"><a href="#树链剖分" class="headerlink" title="树链剖分"></a>树链剖分</h4><p>查询，每次找top的深度最大的点跳，直到两个点的top相同，最后返回深度小的点<br><figure class="highlight cpp"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div><div class="line">35</div><div class="line">36</div><div class="line">37</div><div class="line">38</div><div class="line">39</div><div class="line">40</div><div class="line">41</div><div class="line">42</div><div class="line">43</div><div class="line">44</div><div class="line">45</div><div class="line">46</div><div class="line">47</div><div class="line">48</div><div class="line">49</div><div class="line">50</div><div class="line">51</div><div class="line">52</div><div class="line">53</div><div class="line">54</div><div class="line">55</div><div class="line">56</div><div class="line">57</div><div class="line">58</div><div class="line">59</div><div class="line">60</div><div class="line">61</div><div class="line">62</div><div class="line">63</div><div class="line">64</div><div class="line">65</div><div class="line">66</div><div class="line">67</div><div class="line">68</div><div class="line">69</div><div class="line">70</div></pre></td><td class="code"><pre><div class="line"><span class="meta">#<span class="meta-keyword">include</span><span class="meta-string">&lt;stdio.h&gt;</span></span></div><div class="line"><span class="meta">#<span class="meta-keyword">include</span><span class="meta-string">&lt;iostream&gt;</span></span></div><div class="line"><span class="meta">#<span class="meta-keyword">include</span><span class="meta-string">&lt;vector&gt;</span></span></div><div class="line"><span class="meta">#<span class="meta-keyword">include</span><span class="meta-string">&lt;algorithm&gt;</span></span></div><div class="line"><span class="meta">#<span class="meta-keyword">include</span><span class="meta-string">&lt;ctype.h&gt;</span></span></div><div class="line"><span class="meta">#<span class="meta-keyword">define</span> M 100005</span></div><div class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> <span class="built_in">std</span>;</div><div class="line"><span class="built_in">vector</span>&lt;<span class="keyword">int</span>&gt;edge[M];</div><div class="line"><span class="keyword">int</span> fa[M],dep[M],top[M],sz[M],n;</div><div class="line"><span class="function"><span class="keyword">void</span> <span class="title">Rd</span><span class="params">(<span class="keyword">int</span> &amp;res)</span></span>&#123;</div><div class="line">	<span class="keyword">char</span> c;</div><div class="line">	res=<span class="number">0</span>;</div><div class="line">	<span class="keyword">while</span>(c=getchar(),!<span class="built_in">isdigit</span>(c));</div><div class="line">	<span class="keyword">do</span>&#123;</div><div class="line">		res=(res&lt;&lt;<span class="number">3</span>)+(res&lt;&lt;<span class="number">1</span>)+(c^<span class="string">'0'</span>);</div><div class="line">	&#125;<span class="keyword">while</span>(c=getchar(),<span class="built_in">isdigit</span>(c));</div><div class="line">&#125;</div><div class="line"><span class="function"><span class="keyword">void</span> <span class="title">Pt</span><span class="params">(<span class="keyword">int</span> x)</span></span>&#123;</div><div class="line">	<span class="keyword">if</span>(!x)<span class="keyword">return</span>;</div><div class="line">	Pt(x/<span class="number">10</span>);</div><div class="line">	<span class="built_in">putchar</span>(x%<span class="number">10</span>^<span class="string">'0'</span>);</div><div class="line">&#125;</div><div class="line"><span class="function"><span class="keyword">void</span> <span class="title">makedfs</span><span class="params">(<span class="keyword">int</span> now,<span class="keyword">int</span> las,<span class="keyword">int</span> deep)</span></span>&#123;</div><div class="line">	fa[now]=las,dep[now]=deep,sz[now]=<span class="number">1</span>;</div><div class="line">	<span class="keyword">for</span>(<span class="keyword">int</span> i=<span class="number">0</span>;i&lt;edge[now].size();i++)&#123;</div><div class="line">		<span class="keyword">int</span> p=edge[now][i];</div><div class="line">		<span class="keyword">if</span>(p==las)<span class="keyword">continue</span>;</div><div class="line">		makedfs(p,now,deep+<span class="number">1</span>);</div><div class="line">		sz[now]+=sz[p];</div><div class="line">	&#125;</div><div class="line">&#125;</div><div class="line"><span class="function"><span class="keyword">void</span> <span class="title">maketree</span><span class="params">(<span class="keyword">int</span> now,<span class="keyword">int</span> las,<span class="keyword">int</span> f)</span></span>&#123;</div><div class="line">	top[now]=f;</div><div class="line">	<span class="keyword">int</span> ma=<span class="number">0</span>,pla=<span class="number">-1</span>;</div><div class="line">	<span class="keyword">for</span>(<span class="keyword">int</span> i=<span class="number">0</span>;i&lt;edge[now].size();i++)&#123;</div><div class="line">		<span class="keyword">int</span> p=edge[now][i];</div><div class="line">		<span class="keyword">if</span>(p==las)<span class="keyword">continue</span>;</div><div class="line">		<span class="keyword">if</span>(ma&lt;sz[p])ma=sz[p],pla=p;</div><div class="line">	&#125;</div><div class="line">	<span class="keyword">if</span>(pla!=<span class="number">-1</span>)maketree(pla,now,f);</div><div class="line">	<span class="keyword">for</span>(<span class="keyword">int</span> i=<span class="number">0</span>;i&lt;edge[now].size();i++)&#123;</div><div class="line">		<span class="keyword">int</span> p=edge[now][i];</div><div class="line">		<span class="keyword">if</span>(p==las||p==pla)<span class="keyword">continue</span>;</div><div class="line">		maketree(p,now,p);</div><div class="line">	&#125;</div><div class="line">&#125;</div><div class="line"><span class="function"><span class="keyword">int</span> <span class="title">LCA</span><span class="params">(<span class="keyword">int</span> x,<span class="keyword">int</span> y)</span></span>&#123;</div><div class="line">	<span class="keyword">while</span>(top[x]!=top[y])&#123;</div><div class="line">		<span class="keyword">if</span>(dep[top[x]]&gt;dep[top[y]])x=fa[top[x]];</div><div class="line">		<span class="keyword">else</span> y=fa[top[y]];</div><div class="line">	&#125;</div><div class="line">	<span class="keyword">return</span> dep[x]&lt;dep[y]?x:y;</div><div class="line">&#125;</div><div class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span></span>&#123;</div><div class="line">	<span class="keyword">int</span> m,i,k,j,x,y;</div><div class="line">	Rd(n),Rd(m);</div><div class="line">	<span class="keyword">for</span>(i=<span class="number">1</span>;i&lt;n;i++)&#123;</div><div class="line">		Rd(x),Rd(y);</div><div class="line">		edge[x].push_back(y);</div><div class="line">		edge[y].push_back(x);</div><div class="line">	&#125;</div><div class="line">	makedfs(<span class="number">1</span>,<span class="number">-1</span>,<span class="number">0</span>);</div><div class="line">	maketree(<span class="number">1</span>,<span class="number">-1</span>,<span class="number">1</span>);</div><div class="line">	<span class="keyword">for</span>(i=<span class="number">1</span>;i&lt;=m;i++)&#123;</div><div class="line">		Rd(x),Rd(y);</div><div class="line">		Pt(LCA(x,y));</div><div class="line">		<span class="built_in">putchar</span>(<span class="string">'\n'</span>);</div><div class="line">	&#125;</div><div class="line">	<span class="keyword">return</span> <span class="number">0</span>;</div><div class="line">&#125;</div></pre></td></tr></table></figure></p>
<h3 id="2-点y是否在点x的子树中（dfs序）"><a href="#2-点y是否在点x的子树中（dfs序）" class="headerlink" title="2.点y是否在点x的子树中（dfs序）"></a>2.点y是否在点x的子树中（dfs序）</h3><figure class="highlight cpp"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div></pre></td><td class="code"><pre><div class="line"><span class="meta">#<span class="meta-keyword">include</span><span class="meta-string">&lt;stdio.h&gt;</span></span></div><div class="line"><span class="meta">#<span class="meta-keyword">include</span><span class="meta-string">&lt;iostream&gt;</span></span></div><div class="line"><span class="meta">#<span class="meta-keyword">include</span><span class="meta-string">&lt;algorithm&gt;</span></span></div><div class="line"><span class="meta">#<span class="meta-keyword">include</span><span class="meta-string">&lt;vector&gt;</span></span></div><div class="line"><span class="meta">#<span class="meta-keyword">define</span> M 300005</span></div><div class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> <span class="built_in">std</span>;</div><div class="line"><span class="built_in">vector</span>&lt;<span class="keyword">int</span>&gt;edge[M];</div><div class="line"><span class="keyword">int</span> l[M],r[M],cnt=<span class="number">0</span>;</div><div class="line"><span class="function"><span class="keyword">void</span> <span class="title">dfs</span><span class="params">(<span class="keyword">int</span> now,<span class="keyword">int</span> las)</span></span>&#123;</div><div class="line">	l[now]=++cnt;</div><div class="line">	<span class="keyword">for</span>(<span class="keyword">int</span> i=<span class="number">0</span>;i&lt;edge[now].size();i++)&#123;</div><div class="line">		<span class="keyword">int</span> p=edge[now][i];</div><div class="line">		<span class="keyword">if</span>(p==las)<span class="keyword">continue</span>;</div><div class="line">		dfs(p,now);</div><div class="line">	&#125;</div><div class="line">	r[now]=cnt;</div><div class="line">&#125;</div><div class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span></span>&#123;</div><div class="line">	<span class="keyword">int</span> n,m,i,k,j,x,y;</div><div class="line">	<span class="keyword">for</span>(i=<span class="number">1</span>;i&lt;n;i++)&#123;</div><div class="line">		<span class="built_in">scanf</span>(<span class="string">"%d%d"</span>,&amp;x,&amp;y);</div><div class="line">		edge[x].push_back(y);</div><div class="line">		edge[y].push_back(x);</div><div class="line">	&#125;</div><div class="line">	dfs(<span class="number">1</span>,<span class="number">-1</span>);</div><div class="line">	<span class="keyword">for</span>(i=<span class="number">1</span>;i&lt;=m;i++)&#123;</div><div class="line">		<span class="built_in">scanf</span>(<span class="string">"%d%d"</span>,&amp;x,&amp;y);</div><div class="line">		<span class="keyword">if</span>(l[x]&lt;=l[y]&amp;&amp;r[x]&gt;=l[y])<span class="built_in">puts</span>(<span class="string">"yes"</span>);</div><div class="line">		<span class="keyword">else</span> <span class="built_in">puts</span>(<span class="string">"no"</span>);</div><div class="line">	&#125;</div><div class="line">	<span class="keyword">return</span> <span class="number">0</span>;</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<h3 id="3-判断边e是否在x到y的路径中（dfs序）"><a href="#3-判断边e是否在x到y的路径中（dfs序）" class="headerlink" title="3.判断边e是否在x到y的路径中（dfs序）"></a>3.判断边e是否在x到y的路径中（dfs序）</h3><p>懒得写了。。</p>
<p>这是从某题上扒下来的。。<br><figure class="highlight cpp"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div></pre></td><td class="code"><pre><div class="line"><span class="function"><span class="keyword">bool</span> <span class="title">check</span><span class="params">(<span class="keyword">int</span> k,<span class="keyword">int</span> e)</span></span>&#123;</div><div class="line">	<span class="keyword">int</span> x=a[k].x,y=a[k].y,t=edge[e].to,t1=edge[e].to1;</div><div class="line">	<span class="keyword">if</span>(dep[t]&lt;dep[t1])t=t1;</div><div class="line">	<span class="keyword">int</span> hav=<span class="number">0</span>;</div><div class="line">	<span class="keyword">if</span>(L[x]&gt;=L[t]&amp;&amp;R[x]&lt;=R[t])hav++;</div><div class="line">	<span class="keyword">if</span>(L[y]&gt;=L[t]&amp;&amp;R[y]&lt;=R[t])hav++;</div><div class="line">	<span class="keyword">return</span> (hav==<span class="number">1</span>);</div><div class="line">&#125;</div></pre></td></tr></table></figure></p>
<p>如果这条边出现在了x-y路径中，那么它的深度最大的端点一定是其中一个点的子树点，而另一个点一定是它的子树点。</p>
<h2 id="七-区间上的更新查询"><a href="#七-区间上的更新查询" class="headerlink" title="七.区间上的更新查询"></a>七.区间上的更新查询</h2><h3 id="1-线段树"><a href="#1-线段树" class="headerlink" title="1.线段树"></a>1.线段树</h3><h4 id="单点更新区间查询版"><a href="#单点更新区间查询版" class="headerlink" title="单点更新区间查询版"></a>单点更新区间查询版</h4><p>这里单点更新一点的值，区间查询一段和。当然线段树还有很多功能，这里仅适用一种。<br><br><strong>注意，线段树要开4倍数组</strong><br><figure class="highlight cpp"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div></pre></td><td class="code"><pre><div class="line"><span class="class"><span class="keyword">struct</span> <span class="title">node</span>&#123;</span><span class="keyword">int</span> l,r,v;&#125;tree[<span class="number">4</span>*M];</div><div class="line"><span class="keyword">int</span> a[M];</div><div class="line"><span class="function"><span class="keyword">void</span> <span class="title">build</span><span class="params">(<span class="keyword">int</span> l,<span class="keyword">int</span> r,<span class="keyword">int</span> p)</span></span>&#123;</div><div class="line">	tree[p].l=l,tree[p].r=r;</div><div class="line">	<span class="keyword">if</span>(l==r)&#123;</div><div class="line">		tree[p].v=a[l];</div><div class="line">		<span class="keyword">return</span>;</div><div class="line">	&#125;</div><div class="line">	<span class="keyword">int</span> mid=l+r&gt;&gt;<span class="number">1</span>;</div><div class="line">	build(l,mid,<span class="number">2</span>*p);</div><div class="line">	build(mid+<span class="number">1</span>,r,<span class="number">2</span>*p+<span class="number">1</span>);</div><div class="line">	tree[p].v=tree[p*<span class="number">2</span>].v+tree[p*<span class="number">2</span>+<span class="number">1</span>].v;</div><div class="line">&#125;</div><div class="line"><span class="function"><span class="keyword">int</span> <span class="title">query</span><span class="params">(<span class="keyword">int</span> l,<span class="keyword">int</span> r,<span class="keyword">int</span> p)</span></span>&#123;</div><div class="line">	<span class="keyword">if</span>(tree[p].l==l&amp;&amp;tree[p].r==r)<span class="keyword">return</span> tree[p].v;</div><div class="line">	<span class="keyword">int</span> mid=tree[p].l+tree[p].r&gt;&gt;<span class="number">1</span>;</div><div class="line">	<span class="keyword">if</span>(r&lt;=mid)<span class="keyword">return</span> query(l,r,<span class="number">2</span>*p);</div><div class="line">	<span class="keyword">else</span> <span class="keyword">if</span>(l&gt;mid)<span class="keyword">return</span> query(l,r,<span class="number">2</span>*p+<span class="number">1</span>);</div><div class="line">	<span class="keyword">else</span> <span class="keyword">return</span> query(l,mid,<span class="number">2</span>*p)+query(mid+<span class="number">1</span>,r,<span class="number">2</span>*p+<span class="number">1</span>);</div><div class="line">&#125;</div><div class="line"><span class="function"><span class="keyword">void</span> <span class="title">update</span><span class="params">(<span class="keyword">int</span> x,<span class="keyword">int</span> v,<span class="keyword">int</span> p)</span></span>&#123;</div><div class="line">	<span class="keyword">if</span>(tree[p].l==tree[p].r)&#123;</div><div class="line">		tree[p].v=v;</div><div class="line">		<span class="keyword">return</span>;</div><div class="line">	&#125;</div><div class="line">	<span class="keyword">int</span> mid=tree[p].l+tree[p].r&gt;&gt;<span class="number">1</span>;</div><div class="line">	<span class="keyword">if</span>(x&lt;=mid)update(x,v,<span class="number">2</span>*p);</div><div class="line">	<span class="keyword">else</span> update(x,v,<span class="number">2</span>*p+<span class="number">1</span>);</div><div class="line">	tree[p].v=tree[p*<span class="number">2</span>].v+tree[p*<span class="number">2</span>+<span class="number">1</span>].v;</div><div class="line">&#125;</div></pre></td></tr></table></figure></p>
<h4 id="区间更新区间查询版"><a href="#区间更新区间查询版" class="headerlink" title="区间更新区间查询版"></a>区间更新区间查询版</h4><p>更新区间加减，查询区间和<br><figure class="highlight cpp"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div><div class="line">35</div><div class="line">36</div><div class="line">37</div><div class="line">38</div><div class="line">39</div><div class="line">40</div><div class="line">41</div><div class="line">42</div><div class="line">43</div><div class="line">44</div><div class="line">45</div><div class="line">46</div><div class="line">47</div><div class="line">48</div><div class="line">49</div><div class="line">50</div><div class="line">51</div></pre></td><td class="code"><pre><div class="line"><span class="class"><span class="keyword">struct</span> <span class="title">node</span>&#123;</span><span class="keyword">int</span> l,r,v,las;&#125;tree[<span class="number">4</span>*M];</div><div class="line"><span class="keyword">int</span> a[M];</div><div class="line"><span class="function"><span class="keyword">void</span> <span class="title">build</span><span class="params">(<span class="keyword">int</span> l,<span class="keyword">int</span> r,<span class="keyword">int</span> p)</span></span>&#123;</div><div class="line">	tree[p].l=l,tree[p].r=r,tree[p].las=<span class="number">0</span>;</div><div class="line">	<span class="keyword">if</span>(l==r)&#123;</div><div class="line">		tree[p].v=a[l];</div><div class="line">		<span class="keyword">return</span>;</div><div class="line">	&#125;</div><div class="line">	<span class="keyword">int</span> mid=l+r&gt;&gt;<span class="number">1</span>;</div><div class="line">	build(l,mid,<span class="number">2</span>*p);</div><div class="line">	build(mid+<span class="number">1</span>,r,<span class="number">2</span>*p+<span class="number">1</span>);</div><div class="line">	tree[p].v=tree[p*<span class="number">2</span>].v+tree[p*<span class="number">2</span>+<span class="number">1</span>].v;</div><div class="line">&#125;</div><div class="line"><span class="function"><span class="keyword">void</span> <span class="title">down</span><span class="params">(<span class="keyword">int</span> p)</span></span>&#123;</div><div class="line">	tree[p*<span class="number">2</span>].v+=tree[p].las*(tree[p*<span class="number">2</span>].r-tree[p*<span class="number">2</span>].l+<span class="number">1</span>);</div><div class="line">	tree[p*<span class="number">2</span>+<span class="number">1</span>].v+=tree[p].las*(tree[p*<span class="number">2</span>+<span class="number">1</span>].r-tree[p*<span class="number">2</span>+<span class="number">1</span>].l+<span class="number">1</span>);</div><div class="line">	tree[p*<span class="number">2</span>].las+=tree[p].las;</div><div class="line">	tree[p*<span class="number">2</span>+<span class="number">1</span>].las+=tree[p].las;</div><div class="line">	tree[p].las=<span class="number">0</span>;</div><div class="line">&#125;</div><div class="line"><span class="function">LL <span class="title">query</span><span class="params">(<span class="keyword">int</span> l,<span class="keyword">int</span> r,<span class="keyword">int</span> p)</span></span>&#123;</div><div class="line">	<span class="keyword">if</span>(tree[p].l==l&amp;&amp;tree[p].r==r)<span class="keyword">return</span> tree[p].v;</div><div class="line">	<span class="keyword">if</span>(tree[p].las)down(p);</div><div class="line">	<span class="keyword">int</span> mid=tree[p].l+tree[p].r&gt;&gt;<span class="number">1</span>;</div><div class="line">	<span class="keyword">if</span>(r&lt;=mid)<span class="keyword">return</span> query(l,r,p*<span class="number">2</span>);</div><div class="line">	<span class="keyword">else</span> <span class="keyword">if</span>(l&gt;mid)<span class="keyword">return</span> query(l,r,<span class="number">2</span>*p+<span class="number">1</span>);</div><div class="line">	<span class="keyword">else</span> <span class="keyword">return</span> query(l,mid,<span class="number">2</span>*p)+query(mid+<span class="number">1</span>,r,<span class="number">2</span>*p+<span class="number">1</span>);</div><div class="line">&#125;</div><div class="line"><span class="function"><span class="keyword">void</span> <span class="title">update</span><span class="params">(<span class="keyword">int</span> l,<span class="keyword">int</span> r,<span class="keyword">int</span> v,<span class="keyword">int</span> p)</span></span>&#123;</div><div class="line">	<span class="keyword">if</span>(tree[p].l==l&amp;&amp;tree[p].r==r)&#123;</div><div class="line">		tree[p].v+=v*(r-l+<span class="number">1</span>);</div><div class="line">		tree[p].las+=v;</div><div class="line">		<span class="keyword">return</span>;</div><div class="line">	&#125;</div><div class="line">	<span class="keyword">if</span>(tree[p].las)down(p);</div><div class="line">	<span class="keyword">int</span> mid=tree[p].l+tree[p].r&gt;&gt;<span class="number">1</span>;</div><div class="line">	<span class="keyword">if</span>(r&lt;=mid)update(l,r,v,<span class="number">2</span>*p);</div><div class="line">	<span class="keyword">else</span> <span class="keyword">if</span>(l&gt;mid)update(l,r,v,<span class="number">2</span>*p+<span class="number">1</span>);</div><div class="line">	<span class="keyword">else</span> &#123;</div><div class="line">		update(l,mid,v,<span class="number">2</span>*p);</div><div class="line">		update(mid+<span class="number">1</span>,r,v,<span class="number">2</span>*p+<span class="number">1</span>);</div><div class="line">	&#125;</div><div class="line">	tree[p].v=tree[p*<span class="number">2</span>].v+tree[p*<span class="number">2</span>+<span class="number">1</span>].v;</div><div class="line">&#125;</div><div class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span></span>&#123;</div><div class="line">	<span class="keyword">int</span> n,m,i,k,j,x,y,z;</div><div class="line">	<span class="built_in">scanf</span>(<span class="string">"%d%d"</span>,&amp;n,&amp;m);</div><div class="line">	<span class="keyword">for</span>(i=<span class="number">1</span>;i&lt;=n;i++)<span class="built_in">scanf</span>(<span class="string">"%d"</span>,&amp;a[i]);</div><div class="line">	build(<span class="number">1</span>,n,<span class="number">1</span>);</div><div class="line">	<span class="keyword">return</span> <span class="number">0</span>;</div><div class="line">&#125;</div></pre></td></tr></table></figure></p>
<h3 id="2-树状数组"><a href="#2-树状数组" class="headerlink" title="2.树状数组"></a>2.树状数组</h3><p>树状数组只用开等倍数组<br><figure class="highlight cpp"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div></pre></td><td class="code"><pre><div class="line"><span class="function"><span class="keyword">void</span> <span class="title">add</span><span class="params">(<span class="keyword">int</span> x,<span class="keyword">int</span> v)</span></span>&#123;</div><div class="line">	<span class="keyword">int</span> p=v-a[x];</div><div class="line">	<span class="keyword">int</span> t=x;</div><div class="line">	<span class="keyword">while</span>(x&lt;=n)&#123;</div><div class="line">		BIT[x]+=p;</div><div class="line">		x+=x&amp;(-x);</div><div class="line">	&#125;</div><div class="line">	a[t]=v;</div><div class="line">&#125;</div><div class="line"><span class="function"><span class="keyword">int</span> <span class="title">query</span><span class="params">(<span class="keyword">int</span> x)</span></span>&#123;</div><div class="line">	<span class="keyword">int</span> re=<span class="number">0</span>;</div><div class="line">	<span class="keyword">while</span>(x)&#123;</div><div class="line">		re+=BIT[x];</div><div class="line">		x-=x&amp;(-x);</div><div class="line">	&#125;</div><div class="line">	<span class="keyword">return</span> re;</div><div class="line">&#125;</div><div class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span></span>&#123;</div><div class="line">    <span class="built_in">scanf</span>(<span class="string">"%d"</span>,&amp;n);</div><div class="line">    <span class="keyword">for</span>(i=<span class="number">1</span>;i&lt;=n;i++)&#123;</div><div class="line">        <span class="built_in">scanf</span>(<span class="string">"%d"</span>,&amp;x);</div><div class="line">        add(i,x);</div><div class="line">    &#125;</div><div class="line">    <span class="keyword">return</span> <span class="number">0</span>;</div><div class="line">&#125;</div></pre></td></tr></table></figure></p>
<p><strong>比较一下线段树和树状数组</strong><br><br>最大的差别就是树状数组的代码短了很多，而且在树状数组可解范围内，虽然都是nlogn的，但树状数组要比线段树的常数小很多，所需内存也更小。</p>
<p>但是树状数组不支持同时区间更新和查询，而且它的查询必须是从1开始的，所以不能查询中间一段区间的最值，如果要查询中间一段区间和的话，要拆开来再相减。</p>
<h2 id="八高精"><a href="#八高精" class="headerlink" title="八高精"></a>八高精</h2><figure class="highlight cpp"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div><div class="line">35</div><div class="line">36</div><div class="line">37</div><div class="line">38</div><div class="line">39</div><div class="line">40</div><div class="line">41</div><div class="line">42</div><div class="line">43</div><div class="line">44</div><div class="line">45</div><div class="line">46</div><div class="line">47</div><div class="line">48</div><div class="line">49</div><div class="line">50</div><div class="line">51</div><div class="line">52</div><div class="line">53</div><div class="line">54</div><div class="line">55</div><div class="line">56</div><div class="line">57</div><div class="line">58</div><div class="line">59</div><div class="line">60</div><div class="line">61</div><div class="line">62</div><div class="line">63</div><div class="line">64</div><div class="line">65</div><div class="line">66</div><div class="line">67</div><div class="line">68</div><div class="line">69</div><div class="line">70</div><div class="line">71</div><div class="line">72</div><div class="line">73</div><div class="line">74</div><div class="line">75</div><div class="line">76</div><div class="line">77</div><div class="line">78</div><div class="line">79</div><div class="line">80</div><div class="line">81</div><div class="line">82</div><div class="line">83</div><div class="line">84</div><div class="line">85</div><div class="line">86</div><div class="line">87</div><div class="line">88</div><div class="line">89</div><div class="line">90</div><div class="line">91</div><div class="line">92</div><div class="line">93</div><div class="line">94</div><div class="line">95</div><div class="line">96</div><div class="line">97</div><div class="line">98</div><div class="line">99</div><div class="line">100</div><div class="line">101</div><div class="line">102</div><div class="line">103</div><div class="line">104</div><div class="line">105</div><div class="line">106</div><div class="line">107</div><div class="line">108</div><div class="line">109</div><div class="line">110</div><div class="line">111</div><div class="line">112</div><div class="line">113</div><div class="line">114</div><div class="line">115</div><div class="line">116</div><div class="line">117</div><div class="line">118</div><div class="line">119</div><div class="line">120</div><div class="line">121</div><div class="line">122</div><div class="line">123</div><div class="line">124</div><div class="line">125</div><div class="line">126</div><div class="line">127</div><div class="line">128</div><div class="line">129</div><div class="line">130</div><div class="line">131</div><div class="line">132</div><div class="line">133</div><div class="line">134</div><div class="line">135</div><div class="line">136</div><div class="line">137</div><div class="line">138</div><div class="line">139</div><div class="line">140</div><div class="line">141</div><div class="line">142</div><div class="line">143</div><div class="line">144</div><div class="line">145</div><div class="line">146</div><div class="line">147</div><div class="line">148</div><div class="line">149</div><div class="line">150</div></pre></td><td class="code"><pre><div class="line"><span class="meta">#<span class="meta-keyword">include</span><span class="meta-string">&lt;stdio.h&gt;</span></span></div><div class="line"><span class="meta">#<span class="meta-keyword">include</span><span class="meta-string">&lt;iostream&gt;</span></span></div><div class="line"><span class="meta">#<span class="meta-keyword">include</span><span class="meta-string">&lt;algorithm&gt;</span></span></div><div class="line"><span class="meta">#<span class="meta-keyword">include</span><span class="meta-string">&lt;string.h&gt;</span></span></div><div class="line"><span class="meta">#<span class="meta-keyword">define</span> w 10000</span></div><div class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> <span class="built_in">std</span>;</div><div class="line"><span class="keyword">char</span> p1[<span class="number">100005</span>],p2[<span class="number">10005</span>];</div><div class="line"><span class="class"><span class="keyword">struct</span> <span class="title">num</span>&#123;</span><span class="comment">//这个高精模板都是针对两个正整数 </span></div><div class="line">	<span class="keyword">int</span> l,a[<span class="number">10005</span>];</div><div class="line">	<span class="keyword">bool</span> f;</div><div class="line">	num()&#123;</div><div class="line">		l=<span class="number">0</span>,f=<span class="number">0</span>;</div><div class="line">		<span class="built_in">memset</span>(a,<span class="number">0</span>,<span class="keyword">sizeof</span>(a));</div><div class="line">	&#125;</div><div class="line">	<span class="keyword">bool</span> <span class="keyword">operator</span> &lt;(<span class="keyword">const</span> num p)<span class="keyword">const</span>&#123;</div><div class="line">		<span class="keyword">if</span>(l&gt;p.l)<span class="keyword">return</span> <span class="number">0</span>;</div><div class="line">		<span class="keyword">if</span>(l&lt;p.l)<span class="keyword">return</span> <span class="number">1</span>;</div><div class="line">		<span class="keyword">for</span>(<span class="keyword">int</span> i=l;i&gt;=<span class="number">1</span>;i--)&#123;</div><div class="line">			<span class="keyword">if</span>(a[i]&gt;p.a[i])<span class="keyword">return</span> <span class="number">0</span>;</div><div class="line">			<span class="keyword">if</span>(a[i]&lt;p.a[i])<span class="keyword">return</span> <span class="number">1</span>;</div><div class="line">		&#125;</div><div class="line">		<span class="keyword">return</span> <span class="number">0</span>;</div><div class="line">	&#125;</div><div class="line">	<span class="keyword">bool</span> <span class="keyword">operator</span> &lt;=(<span class="keyword">const</span> num p)<span class="keyword">const</span>&#123;</div><div class="line">		<span class="keyword">if</span>(l&gt;p.l)<span class="keyword">return</span> <span class="number">0</span>;</div><div class="line">		<span class="keyword">if</span>(l&lt;p.l)<span class="keyword">return</span> <span class="number">1</span>;</div><div class="line">		<span class="keyword">for</span>(<span class="keyword">int</span> i=l;i&gt;=<span class="number">1</span>;i--)&#123;</div><div class="line">			<span class="keyword">if</span>(a[i]&gt;p.a[i])<span class="keyword">return</span> <span class="number">0</span>;</div><div class="line">			<span class="keyword">if</span>(a[i]&lt;p.a[i])<span class="keyword">return</span> <span class="number">1</span>;</div><div class="line">		&#125;</div><div class="line">		<span class="keyword">return</span> <span class="number">1</span>;</div><div class="line">	&#125;</div><div class="line">	num <span class="keyword">operator</span> +(<span class="keyword">const</span> num p)<span class="keyword">const</span>&#123;</div><div class="line">		num re;</div><div class="line">		re.l=max(l,p.l);</div><div class="line">		<span class="keyword">for</span>(<span class="keyword">int</span> i=<span class="number">1</span>;i&lt;=re.l;i++)re.a[i]=a[i]+p.a[i];</div><div class="line">		<span class="keyword">for</span>(<span class="keyword">int</span> i=<span class="number">1</span>;i&lt;=re.l;i++)&#123;</div><div class="line">			<span class="keyword">if</span>(re.a[i]&gt;=w)re.a[i+<span class="number">1</span>]++,re.a[i]-=w;</div><div class="line">		&#125;</div><div class="line">		<span class="keyword">if</span>(re.a[re.l+<span class="number">1</span>])re.l++;</div><div class="line">		<span class="keyword">return</span> re;</div><div class="line">	&#125;</div><div class="line">	num <span class="keyword">operator</span> *(<span class="keyword">const</span> num p)<span class="keyword">const</span>&#123;</div><div class="line">		num re;</div><div class="line">		re.l=l+p.l<span class="number">-1</span>;</div><div class="line">		<span class="keyword">for</span>(<span class="keyword">int</span> i=<span class="number">1</span>;i&lt;=l;i++)&#123;</div><div class="line">			<span class="keyword">for</span>(<span class="keyword">int</span> k=<span class="number">1</span>;k&lt;=p.l;k++)re.a[i+k<span class="number">-1</span>]+=a[i]*p.a[k];</div><div class="line">		&#125;</div><div class="line">		<span class="keyword">for</span>(<span class="keyword">int</span> i=<span class="number">1</span>;i&lt;=re.l;i++)&#123;</div><div class="line">			re.a[i+<span class="number">1</span>]+=re.a[i]/w;</div><div class="line">			re.a[i]%=w;</div><div class="line">		&#125;</div><div class="line">		<span class="keyword">if</span>(re.a[re.l+<span class="number">1</span>])re.l++;</div><div class="line">		<span class="keyword">while</span>(re.l&gt;=<span class="number">1</span>&amp;&amp;!re.a[re.l])re.l--;</div><div class="line">		<span class="keyword">return</span> re;</div><div class="line">	&#125;</div><div class="line">	num <span class="keyword">operator</span> -(<span class="keyword">const</span> num p)<span class="keyword">const</span>&#123;</div><div class="line">		num now,re;</div><div class="line">		now.l=l;</div><div class="line">		<span class="keyword">for</span>(<span class="keyword">int</span> i=<span class="number">1</span>;i&lt;=l;i++)now.a[i]=a[i];</div><div class="line">		<span class="keyword">if</span>(now&lt;p)&#123;</div><div class="line">			re.f=<span class="number">1</span>,re.l=p.l;</div><div class="line">			<span class="keyword">for</span>(<span class="keyword">int</span> i=<span class="number">1</span>;i&lt;=p.l;i++)re.a[i]=p.a[i]-a[i];</div><div class="line">			<span class="keyword">for</span>(<span class="keyword">int</span> i=<span class="number">1</span>;i&lt;=p.l;i++)&#123;</div><div class="line">				<span class="keyword">if</span>(re.a[i]&lt;<span class="number">0</span>)re.a[i+<span class="number">1</span>]--,re.a[i]+=w;</div><div class="line">			&#125;</div><div class="line">			<span class="keyword">while</span>(re.l&gt;=<span class="number">1</span>&amp;&amp;!re.a[re.l])re.l--;</div><div class="line">		&#125;</div><div class="line">		<span class="keyword">else</span> &#123;</div><div class="line">			re.l=l;</div><div class="line">			<span class="keyword">for</span>(<span class="keyword">int</span> i=<span class="number">1</span>;i&lt;=l;i++)re.a[i]=a[i]-p.a[i];</div><div class="line">			<span class="keyword">for</span>(<span class="keyword">int</span> i=<span class="number">1</span>;i&lt;=l;i++)&#123;</div><div class="line">				<span class="keyword">if</span>(re.a[i]&lt;<span class="number">0</span>)re.a[i+<span class="number">1</span>]--,re.a[i]+=w;</div><div class="line">			&#125;</div><div class="line">			<span class="keyword">while</span>(re.l&gt;=<span class="number">1</span>&amp;&amp;!re.a[re.l])re.l--;</div><div class="line">		&#125;</div><div class="line">		<span class="keyword">return</span> re;</div><div class="line">	&#125;</div><div class="line">	num <span class="keyword">operator</span> /(<span class="keyword">const</span> num p)<span class="keyword">const</span>&#123;</div><div class="line">		num L,R,now,re;</div><div class="line">		now.l=l;</div><div class="line">		<span class="keyword">for</span>(<span class="keyword">int</span> i=<span class="number">1</span>;i&lt;=l;i++)now.a[i]=a[i];</div><div class="line">		R.l=max(p.l,l),L.l=<span class="number">1</span>,L.l=<span class="number">1</span>;</div><div class="line">		<span class="keyword">for</span>(<span class="keyword">int</span> i=<span class="number">1</span>;i&lt;=R.l;i++)R.a[i]=<span class="number">9999</span>;</div><div class="line">		<span class="keyword">if</span>(now&lt;p)<span class="keyword">return</span> re;</div><div class="line">		<span class="keyword">while</span>(L&lt;=R)&#123;</div><div class="line">			num mid;</div><div class="line">			mid=L+R;</div><div class="line">			mid.half();</div><div class="line">			<span class="keyword">if</span>(now&lt;mid*p)R=mid,R.down();</div><div class="line">			<span class="keyword">else</span> re=mid,L=mid,L.up();</div><div class="line">		&#125;</div><div class="line">		<span class="keyword">return</span> re;</div><div class="line">	&#125;</div><div class="line">	<span class="function"><span class="keyword">void</span> <span class="title">make</span><span class="params">(<span class="keyword">char</span> str[])</span></span>&#123;</div><div class="line">		l=<span class="built_in">strlen</span>(str);</div><div class="line">		<span class="keyword">int</span> cnt=<span class="number">0</span>,i,res;</div><div class="line">		<span class="keyword">for</span>(i=l<span class="number">-1</span>;i<span class="number">-4</span>&gt;=<span class="number">0</span>;i-=<span class="number">4</span>)&#123;</div><div class="line">			res=<span class="number">0</span>;</div><div class="line">			<span class="keyword">for</span>(<span class="keyword">int</span> k=i<span class="number">-3</span>;k&lt;=i;k++)res=(res&lt;&lt;<span class="number">3</span>)+(res&lt;&lt;<span class="number">1</span>)+(str[k]^<span class="string">'0'</span>);</div><div class="line">			a[++cnt]=res;</div><div class="line">		&#125;</div><div class="line">		res=<span class="number">0</span>;</div><div class="line">		<span class="keyword">if</span>(i&gt;=<span class="number">0</span>)&#123;</div><div class="line">			<span class="keyword">for</span>(<span class="keyword">int</span> k=<span class="number">0</span>;k&lt;=i;k++)&#123;</div><div class="line">				res=(res&lt;&lt;<span class="number">3</span>)+(res&lt;&lt;<span class="number">1</span>)+(str[k]^<span class="string">'0'</span>);</div><div class="line">			&#125;</div><div class="line">			a[++cnt]=res;</div><div class="line">		&#125;</div><div class="line">		l=cnt;</div><div class="line">	&#125;</div><div class="line">	<span class="function"><span class="keyword">void</span> <span class="title">half</span><span class="params">()</span></span>&#123;</div><div class="line">		<span class="keyword">for</span>(<span class="keyword">int</span> i=l;i&gt;=<span class="number">1</span>;i--)&#123;</div><div class="line">			a[i<span class="number">-1</span>]+=a[i]%<span class="number">2</span>*w;</div><div class="line">			a[i]/=<span class="number">2</span>;</div><div class="line">		&#125;</div><div class="line">		<span class="keyword">if</span>(!a[l])l--;</div><div class="line">	&#125;</div><div class="line">	<span class="function"><span class="keyword">void</span> <span class="title">down</span><span class="params">()</span></span>&#123;</div><div class="line">		a[<span class="number">1</span>]--;</div><div class="line">		<span class="keyword">for</span>(<span class="keyword">int</span> i=<span class="number">1</span>;i&lt;=l;i++)&#123;</div><div class="line">			<span class="keyword">if</span>(a[i]&lt;<span class="number">0</span>)a[i+<span class="number">1</span>]--,a[i]+=w;</div><div class="line">			<span class="keyword">else</span> <span class="keyword">break</span>;</div><div class="line">		&#125;</div><div class="line">	&#125;</div><div class="line">	<span class="function"><span class="keyword">void</span> <span class="title">up</span><span class="params">()</span></span>&#123;</div><div class="line">		a[<span class="number">1</span>]++;</div><div class="line">		<span class="keyword">for</span>(<span class="keyword">int</span> i=<span class="number">1</span>;i&lt;=l;i++)&#123;</div><div class="line">			<span class="keyword">if</span>(a[i]&gt;=w)a[i]-=w,a[i+<span class="number">1</span>]++;</div><div class="line">			<span class="keyword">else</span> <span class="keyword">break</span>;</div><div class="line">		&#125;</div><div class="line">	&#125;</div><div class="line">	<span class="function"><span class="keyword">void</span> <span class="title">Pf</span><span class="params">()</span></span>&#123;</div><div class="line">		<span class="keyword">if</span>(f)<span class="built_in">putchar</span>(<span class="string">'-'</span>);</div><div class="line">		<span class="keyword">if</span>(l==<span class="number">0</span>)<span class="built_in">putchar</span>(<span class="string">'0'</span>);</div><div class="line">		<span class="keyword">else</span> &#123;</div><div class="line">			<span class="built_in">printf</span>(<span class="string">"%d"</span>,a[l]);</div><div class="line">			<span class="keyword">for</span>(<span class="keyword">int</span> i=l<span class="number">-1</span>;i&gt;=<span class="number">1</span>;i--)<span class="built_in">printf</span>(<span class="string">"%04d"</span>,a[i]);</div><div class="line">		&#125;</div><div class="line">	&#125;</div><div class="line">&#125;;</div><div class="line">num x,y;</div><div class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span></span>&#123;</div><div class="line">	<span class="built_in">scanf</span>(<span class="string">"%s%s"</span>,p1,p2);</div><div class="line">	x.make(p1);</div><div class="line">	y.make(p2);</div><div class="line">	x=x/y;</div><div class="line">	x.Pf();</div><div class="line">	<span class="keyword">return</span> <span class="number">0</span>;</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<h2 id="九-数学"><a href="#九-数学" class="headerlink" title="九.数学"></a>九.数学</h2><h3 id="1-素数"><a href="#1-素数" class="headerlink" title="1.素数"></a>1.素数</h3><h4 id="时间换内存"><a href="#时间换内存" class="headerlink" title="时间换内存"></a>时间换内存</h4><p><strong>对于每个素数复杂度为$\sqrt v$</strong><br><br><figure class="highlight cpp"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div></pre></td><td class="code"><pre><div class="line"><span class="meta">#<span class="meta-keyword">include</span><span class="meta-string">&lt;stdio.h&gt;</span></span></div><div class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span></span>&#123;</div><div class="line">	<span class="keyword">int</span> n,x,i,k;</div><div class="line">	<span class="built_in">scanf</span>(<span class="string">"%d"</span>,&amp;n);</div><div class="line">	<span class="keyword">for</span>(i=<span class="number">1</span>;i&lt;=n;i++)&#123;</div><div class="line">		<span class="built_in">scanf</span>(<span class="string">"%d"</span>,&amp;x);</div><div class="line">		<span class="keyword">bool</span> su=<span class="number">1</span>;</div><div class="line">		<span class="keyword">for</span>(k=<span class="number">2</span>;k*k&lt;=x&amp;&amp;su;k++)<span class="keyword">if</span>(x%k==<span class="number">0</span>)su=<span class="number">0</span>;</div><div class="line">		<span class="keyword">if</span>(su)<span class="built_in">puts</span>(<span class="string">"yes"</span>);</div><div class="line">		<span class="keyword">else</span> <span class="built_in">puts</span>(<span class="string">"no"</span>);</div><div class="line">	&#125;</div><div class="line">	<span class="keyword">return</span> <span class="number">0</span>;</div><div class="line">&#125;</div></pre></td></tr></table></figure></p>
<h4 id="内存换时间"><a href="#内存换时间" class="headerlink" title="内存换时间"></a>内存换时间</h4><p>必须将所有[1,v]的数字全都判一遍<br><figure class="highlight cpp"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div></pre></td><td class="code"><pre><div class="line"><span class="meta">#<span class="meta-keyword">include</span><span class="meta-string">&lt;stdio.h&gt;</span></span></div><div class="line"><span class="meta">#<span class="meta-keyword">define</span> M <span class="comment">/*所要判断的素数范围*/</span>2000005</span></div><div class="line"><span class="keyword">bool</span> mark[M];</div><div class="line"><span class="keyword">int</span> cnt=<span class="number">0</span>,su[M];</div><div class="line"><span class="function"><span class="keyword">void</span> <span class="title">makesu</span><span class="params">()</span></span>&#123;</div><div class="line">	<span class="keyword">for</span>(<span class="keyword">int</span> i=<span class="number">2</span>;i&lt;=M<span class="number">-5</span>;i++)&#123;</div><div class="line">		<span class="keyword">if</span>(mark[i])<span class="keyword">continue</span>;</div><div class="line">		su[++cnt]=i;</div><div class="line">		<span class="keyword">for</span>(<span class="keyword">int</span> k=i+i;k&lt;=M<span class="number">-5</span>;k+=i)mark[k]=<span class="number">1</span>;</div><div class="line">	&#125;</div><div class="line">&#125;</div><div class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span></span>&#123;</div><div class="line">	<span class="keyword">int</span> n,i,k,j,x;</div><div class="line">	makesu();</div><div class="line">	<span class="built_in">scanf</span>(<span class="string">"%d"</span>,&amp;n);</div><div class="line">	<span class="keyword">for</span>(i=<span class="number">1</span>;i&lt;=n;i++)&#123;</div><div class="line">		<span class="built_in">scanf</span>(<span class="string">"%d"</span>,&amp;x);</div><div class="line">		<span class="keyword">if</span>(mark[x])<span class="built_in">puts</span>(<span class="string">"no"</span>);</div><div class="line">		<span class="keyword">else</span> <span class="built_in">puts</span>(<span class="string">"yes"</span>);</div><div class="line">	&#125;</div><div class="line">	<span class="keyword">return</span> <span class="number">0</span>;</div><div class="line">&#125;</div></pre></td></tr></table></figure></p>
<h3 id="2-扩展欧几里德"><a href="#2-扩展欧几里德" class="headerlink" title="2.扩展欧几里德"></a>2.扩展欧几里德</h3><p><a href="http://blog.csdn.net/kanosword/article/details/52525599" target="_blank" rel="external">Kanosword整理的扩展欧几里德</a><br><figure class="highlight cpp"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div></pre></td><td class="code"><pre><div class="line"><span class="meta">#<span class="meta-keyword">include</span><span class="meta-string">&lt;stdio.h&gt;</span></span></div><div class="line"><span class="function"><span class="keyword">int</span> <span class="title">gcd</span><span class="params">(<span class="keyword">int</span> a,<span class="keyword">int</span> b,<span class="keyword">int</span> &amp;x,<span class="keyword">int</span> &amp;y)</span></span>&#123;</div><div class="line">	<span class="keyword">if</span>(b==<span class="number">0</span>)&#123;</div><div class="line">		x=<span class="number">1</span>,y=<span class="number">0</span>;</div><div class="line">		<span class="keyword">return</span> a;</div><div class="line">	&#125;</div><div class="line">	<span class="keyword">int</span> p=gcd(b,a%b,y,x);</div><div class="line">	y-=a/b*x;</div><div class="line">	<span class="keyword">return</span> p;</div><div class="line">&#125;</div><div class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span></span>&#123;</div><div class="line">	<span class="keyword">int</span> a,b,x,y;</div><div class="line">	<span class="built_in">scanf</span>(<span class="string">"%d%d"</span>,&amp;a,&amp;b);</div><div class="line">	<span class="keyword">int</span> p=gcd(a,b,x,y);</div><div class="line">	<span class="built_in">printf</span>(<span class="string">"%d\n"</span>,(x%b+b)%b);</div><div class="line">	<span class="keyword">return</span> <span class="number">0</span>;</div><div class="line">&#125;</div></pre></td></tr></table></figure></p>
<h2 id="十-图论"><a href="#十-图论" class="headerlink" title="十.图论"></a>十.图论</h2><h3 id="1-匈牙利算法。"><a href="#1-匈牙利算法。" class="headerlink" title="1.匈牙利算法。"></a>1.匈牙利算法。</h3><p><a href="http://blog.csdn.net/dark_scope/article/details/8880547" target="_blank" rel="external">这篇博客写得非常不错</a></p>
<p>匈牙利算法用于二分图匹配。核心思想就是找位子，没位子的话就让之前占住的位子腾，如果能腾出就放。<br><figure class="highlight cpp"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div></pre></td><td class="code"><pre><div class="line"><span class="function"><span class="keyword">bool</span> <span class="title">find</span><span class="params">(<span class="keyword">int</span> x)</span></span>&#123;</div><div class="line">	<span class="keyword">for</span>(<span class="keyword">int</span> i=<span class="number">1</span>;i&lt;=n;i++)&#123;<span class="comment">//uesd是"位子"是否使用，to是占用"位子"的人。</span></div><div class="line">		<span class="keyword">if</span>(used[i]||edge[x][i]==<span class="string">'N'</span>)<span class="keyword">continue</span>;</div><div class="line">		used[i]=<span class="number">1</span>;</div><div class="line">		<span class="keyword">if</span>(!to[i]||find(to[i],a))&#123;</div><div class="line">			to[i]=x;</div><div class="line">			<span class="keyword">return</span> <span class="number">1</span>;</div><div class="line">		&#125;</div><div class="line">	&#125;</div><div class="line">	<span class="keyword">return</span> <span class="number">0</span>;</div><div class="line">&#125;</div></pre></td></tr></table></figure></p>
<figure class="highlight cpp"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div></pre></td><td class="code"><pre><div class="line">sz=<span class="number">0</span>;</div><div class="line"><span class="keyword">for</span>(i=<span class="number">1</span>;i&lt;=n;i++)&#123;</div><div class="line">    <span class="built_in">memset</span>(used,<span class="number">0</span>,<span class="keyword">sizeof</span>(used));</div><div class="line">    <span class="keyword">if</span>(find(i,j))sz++;</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<p>这里提一句，最大匹配数=点集大小-最大独立集大小，这条等式很有用。</p>
<h2 id="十一-字符串"><a href="#十一-字符串" class="headerlink" title="十一.字符串"></a>十一.字符串</h2><h3 id="1-KMP"><a href="#1-KMP" class="headerlink" title="1.KMP"></a>1.KMP</h3><p><a href="http://blog.csdn.net/yutianzuijin/article/details/11954939/" target="_blank" rel="external">KMP算法详解</a></p>
<p>在常规$O(n^2)$匹配过程，用一个失败指针fail，回到能保留的最长的匹配位置。$fail[]$指针表示你先能回到匹配了$fail[i]-1$个的情况，这种定义有利于下面的代码。<br><figure class="highlight cpp"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div></pre></td><td class="code"><pre><div class="line"><span class="function"><span class="keyword">void</span> <span class="title">get</span><span class="params">()</span></span>&#123;</div><div class="line">	fail[<span class="number">1</span>]=<span class="number">0</span>,fail[<span class="number">2</span>]=<span class="number">1</span>;</div><div class="line">	<span class="keyword">for</span>(<span class="keyword">int</span> i=<span class="number">2</span>;i&lt;=m;i++)&#123;</div><div class="line">		<span class="keyword">int</span> j=fail[i];</div><div class="line">		<span class="keyword">while</span>(j&amp;&amp;b[j]!=a[i])j=fail[j];<span class="comment">//匹配到时恰好等于fail[j]</span></div><div class="line">		fail[i+<span class="number">1</span>]=j+<span class="number">1</span>;</div><div class="line">	&#125;</div><div class="line">&#125;</div><div class="line"><span class="function"><span class="keyword">void</span> <span class="title">match</span><span class="params">()</span></span>&#123;</div><div class="line">	<span class="keyword">for</span>(<span class="keyword">int</span> i=<span class="number">1</span>,j=<span class="number">1</span>;i&lt;=n;i++)&#123;</div><div class="line">		<span class="keyword">while</span>(j&amp;&amp;b[j]!=a[i])j=fail[j];</div><div class="line">		j++;</div><div class="line">		<span class="keyword">if</span>(j==m+<span class="number">1</span>)j=fail[j],cnt++;<span class="comment">//成功匹配</span></div><div class="line">	&#125;</div><div class="line">&#125;</div></pre></td></tr></table></figure></p>
<h3 id="2-trie-tree"><a href="#2-trie-tree" class="headerlink" title="2.trie tree"></a>2.trie tree</h3><p>字典树的速度还可以，但是内存消耗量非常大，如果题目没有说明读入字符量不超过多少，最好还是别用。构建非常简单，就是用指针将字符串转成一棵树。<br><figure class="highlight cpp"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div></pre></td><td class="code"><pre><div class="line"><span class="function"><span class="keyword">void</span> <span class="title">build_trie</span><span class="params">()</span></span>&#123;</div><div class="line">	<span class="keyword">int</span> cur=<span class="number">0</span>;</div><div class="line">	<span class="keyword">int</span> len=<span class="built_in">strlen</span>(a);</div><div class="line">	<span class="keyword">for</span>(<span class="keyword">int</span> i=<span class="number">0</span>;i&lt;len;i++)&#123;</div><div class="line">		<span class="keyword">int</span> to=a[i]-<span class="string">'a'</span>;</div><div class="line">		<span class="keyword">if</span>(!pre[cur][to])pre[cur][to]=++id;</div><div class="line">		cur=pre[cur][to];</div><div class="line">	&#125;</div><div class="line">&#125;</div></pre></td></tr></table></figure></p>

            <div class="clearfix"></div>
            <hr class="nogutter">
        </div>
        <nav class="pagination" role="pagination">
    
    <a class="pull-left" href="/2017/08/16/2017.8.14离线赛题解/" style="float: left;">
        ← 2017.8.14离线赛题解
    </a>
    
    
    <a class="pull-right" href="/2017/08/10/2017.8.7离线赛题解/">
        2017.8.7离线赛题解 →
    </a>
    
</nav>

        <div class="duoshuo">


</div>
    </div>
</section>


      
<!-- ============================ Footer =========================== -->

<footer>
    <div class="container">
            <div class="copy">
                <p>
                    &copy; 2014<script>new Date().getFullYear()>2010&&document.write("-"+new Date().getFullYear());</script>, Content By yokel. All Rights Reserved.
                </p>
                <p>Theme By <a href="//go.kieran.top" style="color: #767D84">Kieran</a></p>
            </div>
            <div class="social">
                <ul>
                    
                    <li><a href="https://github.com/" title="Github" target="_blank"><i class="icon-github"></i></a>&nbsp;</li>
                    
                    
                    <li><a href="https://twitter.com/" title="Twitter" target="_blank"><i class="icon-twitter"></i></a>&nbsp;</li>
                    
                    
                    <li><a href="https://www.facebook.com/" title="Facebook" target="_blank"><i class="icon-facebook"></i></a>&nbsp;</li>
                    
                    
                    
                </ul>
            </div>
            <div class="clearfix"> </div>
        </div>
<iframe frameborder="no" border="0" marginwidth="0" marginheight="0" width=330 height=86 src="//music.163.com/outchain/player?type=2&id=26427669&auto=1&height=66"></iframe>
</footer>

<!-- ============================ END Footer =========================== -->
      <!-- Load our scripts -->
<!-- Resizable 'on-demand' full-height hero -->
<script type="text/javascript">
    var resizeHero = function () {
        var hero = $(".cover,.heightblock"),
            window1 = $(window);
        hero.css({
            "height": window1.height()
        });
    };

    resizeHero();

    $(window).resize(function () {
        resizeHero();
    });
</script>
<script src="/js/plugins.min.js"></script><!-- Bootstrap core and concatenated plugins always load here -->
<script src="/js/jquery.flexslider-min.js"></script><!-- Flexslider plugin -->
<script src="/js/scripts.js"></script><!-- Theme scripts -->


<link rel="stylesheet" href="/fancybox/jquery.fancybox.css" media="screen" type="text/css">
<script src="/fancybox/jquery.fancybox.pack.js"></script>
<script type="text/javascript">
$('#intro').find('img').each(function(){
  var alt = this.alt;

  if (alt){
    $(this).after('<span class="caption" style="display:none">' + alt + '</span>');
  }

  $(this).wrap('<a href="' + this.src + '" title="' + alt + '" class="fancybox" rel="gallery" />');
});
(function($){
  $('.fancybox').fancybox();
})(jQuery);
</script>

<!-- Initiate flexslider plugin -->
<script type="text/javascript">
    $(document).ready(function($) {
      (function(){
        console.log('font');
        var getCss = function(path) {
          var head = document.getElementsByTagName('head')[0];
          link = document.createElement('link');
          link.href = path;
          link.rel = 'stylesheet';
          link.type = 'text/css';
          head.appendChild(link);
        };
        getCss('https://fonts.googleapis.com/css?family=Montserrat:400,700');
        getCss('https://fonts.googleapis.com/css?family=Open+Sans:400,600');
      })();
      $('.flexslider').flexslider({
        animation: "fade",
        prevText: "",
        nextText: "",
        directionNav: true
      });
    });
</script>

</body>
</html>
